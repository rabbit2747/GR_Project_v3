# 프로젝트 지시사항 및 룰

## 📋 문서 목적

이 문서는 프로젝트 진행 중 사용자가 지시한 모든 룰과 지침을 기록합니다.
프로젝트의 일관성을 유지하고 향후 참조를 위해 작성되었습니다.

**최종 업데이트**: 2025-11-20 (v2.2)

---

## 🎯 Phase 구분 및 범위

> **참고**: 본 Phase는 **기술 구현 단계**를 의미합니다.
> 사업 실행 단계(Phase 0: PoC, Phase 1: AI 자동화, Phase 2: 생태계 완성)는 `GR_생태계_마스터플랜_v2.0.md` 참조.

---

### Phase 0: GR 프레임워크 기반 설계 (완료) 🆕

**목표**: GR 생태계의 North Star 정의 및 핵심 아키텍처 설계

**대상**:
- GR 생태계 비전 및 철학 정의 (Foundation, not Product)
- 3D 프레임워크 v2.0 명세 (Layer × Zone × Tag)
- 하이브리드 DB 아키텍처 설계 (PostgreSQL + Neo4j + Pinecone)
- 2-Tier 데이터 모델 설계 (Product Master + Component Archetypes)

**산출물** (v2.0):
- ✅ `GR_생태계_마스터플랜_v2.0.md` (North Star 문서)
- ✅ `DB_아키텍처_설계서_v2.0.md` (하이브리드 DB 설계)
- ✅ `00_인프라_구조도_분류체계_v2.0.md` (3D 프레임워크 명세)

**핵심 결정사항**:
- ✅ Layer 0 신설 (External Services)
- ✅ Layer 7 확장 (AI 워크로드 포함)
- ✅ Zone 0 세분화 (0-A: Untrusted, 0-B: Trusted Partner)
- ✅ Domain T 추가 (Tech Stack: 언어, 런타임, OS)
- ✅ Domain I 추가 (Interface: 프로토콜, 데이터 포맷)
- ✅ PostgreSQL + Neo4j + Pinecone Day 1 구축 결정

**LLM 사용 전략** (Phase 0-2 공통) 🆕:
- **GR DB 구축 단계 (Phase 0-2)**:
  - 외부 LLM API 자유 사용 (GPT-4, Claude, Gemini 등)
  - 제품 정보 수집, Archetype 추론, CVE 분석 등에 활용
  - 비용: 연간 약 $1,000 (임베딩 + 추론)
  - 기밀 데이터 없음 (공개 제품 정보만 처리)
- **고객 배포 단계** (Phase 2 이후):
  - 80% Direct Query: PostgreSQL/Neo4j 직접 쿼리 (AI 불필요)
  - 20% AI-Assisted: 복잡한 추론 필요 시
    - 옵션 1: On-premise LLM (고객사 내부, 기밀 유지)
    - 옵션 2: 익명화 후 외부 LLM API 사용

---

### Phase 1: 분류 체계 골격 구축 (현재 진행 중)

**목표**: 분류 기준 자체를 문서화 및 DB화

**대상** (v2.0 업데이트):
- 3개 차원 (Dimension) 정의
- **8개 Layer** (L0-L7 + Cross) 상세 설명
  - 🆕 Layer 0: External Services
  - ✨ Layer 7: Application & AI (LLM, Vector Search, RAG 포함)
- **7개 Zone** (보안 영역) 상세 설명
  - 🆕 Zone 0-A: Untrusted External (0%)
  - 🆕 Zone 0-B: Trusted Partner (10%)
  - Zone 1-5 (기존)
- **10개 Tag Domain** (v2.0 확장)
  - M (Monitoring), N (Network), S (Security), A (Application), D (Data)
  - R (Resource), C (Compute), P (Platform)
  - 🆕 T (Tech Stack) - CVE 매핑용
  - 🆕 I (Interface) - 통신 흐름 분석용
- **280+ Function Tags** 정의 (기존 210+ → 70개 추가)
- Layer × Zone 매핑 관계
- Tag 조합 패턴

**산출물** (v2.0):
- 25개+ Markdown 문서 (Domain T, I 추가로 증가)
- SQL 스키마 (분류 체계용, 하이브리드 DB)
- Seed 데이터 (분류 정의, 280+ tags)
- ERD 다이어그램 (PostgreSQL + Neo4j + Pinecone)

**DB 테이블** (Phase 1, v2.0):
- `dimensions`
- `layers` (8개: L0-L7 + Cross)
- `zones` (7개: Zone 0-A, 0-B, 1-5)
- `tag_domains` (10개: M, N, S, A, D, R, C, P, T, I)
- `function_tags` (280+ tags)
- `layer_zone_mapping`
- `tag_combinations`

**중요**: 실제 구성요소(제품, 소프트웨어 등)는 Phase 1에 포함되지 않습니다.

---

### Phase 2: 구성요소 매핑 (향후 계획)

**목표**: 실제 제품/기술을 분류 골격에 Pre-Mapping (선제적 정의)

**대상**:
- **시장의 모든 주요 IT 제품 수집 (단계별 확장)**
  - **Phase 2-1 (핵심 제품군)**: 100-300개 제품
    - 자동진단 솔루션 대상 제품 우선 (Apache, Nginx, MySQL, PostgreSQL, Redis, MongoDB, Kafka, RabbitMQ, Docker, Kubernetes, Terraform 등)
    - 주요 클라우드 서비스 (AWS, Azure, GCP 핵심 서비스)
  - **Phase 2-2 (확장)**: 1,000개 제품
    - 백업, 모니터링, 네트워크 장비 등 추가 제품군
  - **Phase 2-3 (전체)**: 10,000개 제품
    - 롱테일 제품, 레거시 시스템 포함
- 각 구성요소의 상세 정보 (벤더, 버전, 라이선스, CVE)
- 구성요소 → **Component Archetypes** 매핑 (가능한 모든 역할 정의)
- PostgreSQL (Product Master) + Neo4j (Archetypes) + Pinecone (Embeddings)
- 🆕 **취약점 관리 & MITRE ATT&CK 통합**

**추가 DB 테이블** (Phase 2, 향후):
- `products` - 제품 기본 정보 (PostgreSQL)
- `vendors` - 벤더 정보 (PostgreSQL)
- `licenses` - 라이선스 정보 (PostgreSQL)
- `versions` - 버전 이력 (PostgreSQL)
- `cves` - CVE 취약점 (PostgreSQL)
- 🆕 `mitre_techniques` - MITRE ATT&CK 기법 (PostgreSQL)
- 🆕 `cve_mitre_mapping` - CVE-MITRE 매핑 (PostgreSQL)
- `product_nodes` - 제품 노드 (Neo4j)
- `archetype_nodes` - 원형 노드 (Neo4j)
- `product_archetype_relationships` - 관계 (Neo4j)
- 🆕 `attack_path_nodes` - 공격 경로 노드 (Neo4j)
- 🆕 `zone_to_zone_attack_edges` - Zone 간 공격 관계 (Neo4j)
- `product_embeddings` - 벡터 임베딩 (Pinecone)

**취약점 관리 & MITRE ATT&CK 통합** 🆕:
- **CVE 데이터베이스 구축**:
  - 100,000+ CVE 레코드 수집 (NVD, MITRE)
  - CVE → 제품/버전 매핑
  - CVE → GR Framework 컨텍스트 (Layer × Zone × Tag) 매핑
- **MITRE ATT&CK 통합**:
  - MITRE Techniques (200+) 수집
  - GR Framework = "WHERE" (어디에서 공격 발생)
  - MITRE ATT&CK = "HOW" (어떻게 공격 수행)
  - CVE + MITRE + GR Framework 3-Way 통합
- **Attack Path 시뮬레이션**:
  - Zone-to-Zone 공격 경로 그래프 (Neo4j)
  - CVE 취약점 체인 분석
  - Layer별 방어 전략 자동 생성
- **AI 기반 추론 시스템**:
  - DB 기반 추론 + Web Search 교차 검증
  - 신규 제품 Archetype 자동 추론
  - MITRE 기법 자동 매핑

**원칙** (v2.0 업데이트):
- Phase 0의 설계 기반으로 Phase 1에서 분류 골격 완성
- Phase 1의 뼈대를 기반으로 Phase 2에서 모든 제품을 Pre-Mapping
- **Pre-Mapping**: 고객 데이터 분석 전에 모든 제품의 가능한 역할을 미리 정의
- 🆕 **CVE + MITRE 통합**: 취약점의 "WHERE"와 "HOW"를 결합하여 실행 가능한 보안 전략 제공

---

## 📝 문서 작성 룰

### 1. 문서 크기 제한

**룰**: 각 문서는 Claude Code가 한 번에 읽을 수 있는 크기보다 작아야 함

**기준**:
- 일반적으로 ~2000 라인 이하
- 한 번에 읽기 어려운 경우 분할

**분할 방법**:
```
원본: Layer_5_Data.md

분할:
- Layer_5_Data_1.md (기본 정보, 개요)
- Layer_5_Data_2.md (상세 설명 계속)
- Layer_5_Data_3.md (예시 및 참고 자료)
```

**적용 사례**:
- 내용이 많은 Layer 문서
- Function Tag 도메인 문서 (210+ 태그)
- 복잡한 Zone 문서

---

### 2. 작성 언어

**룰**: 모든 문서는 한글로 작성

**예외**:
- 기술 용어는 영문 병기 가능 (예: `Layer 7: 비즈니스 로직 & 애플리케이션 (Business Logic & Application)`)
- 코드 예시, SQL 스키마는 영문 사용
- 제품명, 브랜드명은 원어 사용

**작성 스타일**:
- 명확하고 간결한 한글
- 전문 용어는 첫 사용 시 설명 추가
- 표, 다이어그램 활용

---

### 3. 문서 구조 일관성

**표준 섹션**:
1. 문서 정보 (메타데이터)
2. 정의 및 목적
3. 주요 구성요소
4. Zone별 배치 패턴
5. 아키텍처 다이어그램
6. 실무 고려사항
7. 관련 문서
8. 참고 자료

**템플릿 사용**:
- Layer 문서 템플릿
- Zone 문서 템플릿
- Function Tag Domain 문서 템플릿

---

### 4. 문서 모듈화 및 독립성 ⭐ NEW

**핵심 원칙**: 각 정보 단위를 독립적인 문서로 분리하여 DB화 및 모듈화

**문제점** (기존 방식):
- 하나의 문서에 Layer 정의 + 모든 구성요소 설명 포함
- 새 구성요소 추가 시 → 기존 문서 수정 필요 → 문서 비대화
- 모듈화되지 않아 독립적 관리 어려움

**해결 방법** (새로운 3단계 계층 구조):

```
01_차원1_Deployment_Layer/
├── 00_차원1_개요.md                    # Level 1: 차원 전체 개요
│
├── Layer_1_Physical/                   # Level 2: Layer 디렉토리
│   ├── 00_Layer_1_정의.md             # Layer 자체 정의/정보만
│   │
│   ├── 01_Data_Center/                # Level 3: 구성요소 디렉토리
│   │   └── 00_Data_Center_정의.md     # 구성요소 정의/정보
│   │
│   ├── 02_Server_Hardware/
│   │   └── 00_Server_Hardware_정의.md
│   │
│   └── 03_Storage/
│       └── 00_Storage_정의.md
│
├── Layer_2_Network/
│   ├── 00_Layer_2_정의.md
│   ├── 01_Load_Balancer/
│   │   └── 00_Load_Balancer_정의.md
│   └── ...
```

**각 레벨의 역할**:

**Level 1** (`00_차원X_개요.md`):
- 해당 차원의 전체 개요만
- 예: 8개 Layer 목록 및 간단한 설명

**Level 2** (`Layer_X/00_Layer_X_정의.md`):
- 해당 Layer의 정의, 역할, 특징만
- 주요 구성요소 **목록**만 (상세 설명 제외)
- Zone 배치 패턴 개요

**Level 3** (`구성요소_디렉토리/00_구성요소_정의.md`):
- 해당 구성요소의 정의, 기능, 특징
- Function Tag, Zone 배치 정보
- 대표 제품 목록
- 코드 예시 및 아키텍처

**Level 4** (Phase 2, 향후):
- 개별 제품/노드 문서
- 예: `Dell_PowerEdge_R750.md`

**장점**:
- ✅ **독립성**: 각 정보 = 독립 문서 = DB 레코드화 가능
- ✅ **확장성**: 새 구성요소 추가 시 새 디렉토리만 생성
- ✅ **모듈화**: 기존 문서 수정 최소화
- ✅ **재사용성**: 구성요소 문서를 다른 곳에서도 참조 가능

**명명 규칙**:
- Level 2 디렉토리: `Layer_{N}_{영문명}/`
- Level 2 정의 문서: `00_Layer_{N}_정의.md`
- Level 3 디렉토리: `{번호}_{구성요소_영문명}/`
- Level 3 정의 문서: `00_{구성요소_영문명}_정의.md`

---

## 🗄️ 데이터베이스 룰

### 1. Phase별 스키마 분리

**Phase 1 스키마**:
- 분류 기준만 포함
- 구성요소 테이블 제외

**Phase 2 스키마** (향후):
- 구성요소 테이블 추가
- Phase 1 스키마와 연동

### 2. Seed 데이터 작성 (v2.0 업데이트)

**포함 사항** (v2.0):
- 3개 차원
- **8개 Layer** (L0-L7 + Cross)
- **7개 Zone** (Zone 0-A, 0-B, 1-5)
- **10개 Tag Domain** (M, N, S, A, D, R, C, P, T, I)
- **280+ Function Tags**
  - Domain M: 8 tags
  - Domain N: 8 tags
  - Domain S: 11 tags
  - Domain A: 13 tags (AI 워크로드 포함)
  - Domain D: 19 tags (벡터 DB 포함)
  - Domain R: 5 tags
  - Domain C: 6 tags
  - Domain P: 8 tags
  - 🆕 Domain T: 18 tags (Tech Stack)
  - 🆕 Domain I: 14 tags (Interface)
- Layer × Zone 매핑 (약 50개, Zone 0-A/0-B 추가로 증가)
- Tag 조합 (70+개, AI/ML 워크로드 조합 추가)

**제외 사항** (Phase 1):
- 실제 제품/소프트웨어 데이터 (Phase 2로 이관)

---

## 📁 디렉토리 구조 룰

### 표준 폴더 구조

```
종합/
├── DB_분류체계/
│   ├── 00_분류체계_개요.md
│   ├── 01_차원1_Deployment_Layer/
│   │   ├── 00_차원1_개요.md
│   │   ├── Layer_1_Physical.md
│   │   ├── Layer_2_Network.md
│   │   └── ...
│   ├── 02_차원2_Security_Zone/
│   │   ├── 00_차원2_개요.md
│   │   ├── Zone_1_Perimeter.md
│   │   └── ...
│   ├── 03_차원3_Function_Tag/
│   │   ├── 00_차원3_개요.md
│   │   ├── Domain_N_Network.md
│   │   └── ...
│   └── 04_데이터베이스/
│       ├── schema_classification.sql
│       ├── seed_classification.sql
│       └── ER_Diagram.md
├── DB_분류체계_구축_계획.md
├── 지시사항.md (본 문서)
└── 00_인프라_구조도_분류체계.md (기준 문서)
```

### 명명 규칙

**폴더명**:
- 숫자 접두사 사용 (순서 명확화)
- 한글명_영문명 형식

**파일명**:
- `00_개요.md`: 각 차원/섹션의 개요
- `Layer_{N}_{영문명}.md`: Layer별 문서
- `Zone_{N}_{영문명}.md`: Zone별 문서
- `Domain_{Code}_{영문명}.md`: Tag Domain별 문서

---

## 🗓️ 작업 순서

### 1단계: 기반 문서 (차원 + Layer)

**작성 문서**:
1. `00_분류체계_개요.md`
2. `01_차원1_Deployment_Layer/00_차원1_개요.md`
3. `Layer_1_Physical.md` ~ `Layer_Cross_Management.md` (8개)

**총 10개 문서**

### 2단계: Zone + Tag 도메인 (1차)

**작성 문서**:
1. `02_차원2_Security_Zone/00_차원2_개요.md`
2. `Zone_1_Perimeter.md` ~ `Zone_5_Endpoint.md` (5개)
3. `03_차원3_Function_Tag/00_차원3_개요.md`
4. `Domain_N_Network.md`, `Domain_S_Security.md` (2개)

**총 9개 문서**

### 3단계: Tag 도메인 완료 + DB

**작성 문서**:
1. `Domain_A_Application.md` ~ `Domain_I_Integration.md` (6개)
2. `schema_classification.sql`
3. `seed_classification.sql`
4. `ER_Diagram.md`

**총 9개 문서 + SQL**

---

## ✅ 품질 기준

### 문서 품질

**필수 요소**:
- [ ] 문서 정보 테이블 포함
- [ ] 명확한 정의 및 목적
- [ ] 구체적인 예시 (최소 3개)
- [ ] 다이어그램 또는 표
- [ ] 관련 문서 링크

**검증 기준**:
- 기술 용어 정확성
- 예시의 현실성
- 다른 문서와의 일관성

### 데이터베이스 품질

**필수 요소**:
- [ ] 정규화된 스키마
- [ ] Primary Key 및 Foreign Key 정의
- [ ] 인덱스 고려
- [ ] Seed 데이터 검증

---

## 📌 주요 원칙

### 1. Phase 구분 엄수

**절대 규칙**: Phase 1에서는 구성요소 테이블 및 데이터를 생성하지 않음

**Phase 1 포함**:
- ✅ 차원, Layer, Zone, Tag 정의
- ✅ 관계 매핑 (Layer × Zone)
- ✅ 분류 기준 설명

**Phase 1 제외**:
- ❌ Apache, Nginx 등 개별 제품 테이블
- ❌ 구성요소별 상세 정보
- ❌ 제품 카탈로그

### 2. 뼈대 우선, 매핑 후순

**순서**:
1. 분류 체계 골격 완성 (Phase 1)
2. 골격 검증 및 수정
3. 구성요소 수집 및 정리 (Phase 2)
4. 골격에 구성요소 매핑 (Phase 2)

### 3. 일관성 유지

**모든 문서**:
- 동일한 용어 사용
- 동일한 구조 유지
- 상호 참조 정확성

---

## 🔄 변경 이력

| 날짜 | 내용 | 작성자 |
|------|------|--------|
| 2025-11-05 | 초기 작성 - Phase 구분, 문서 크기 제한, 한글 작성 룰 | User + Claude |
| 2025-11-05 | 문서 모듈화 및 독립성 룰 추가 - 3단계 계층 구조 (차원 → Layer → 구성요소) | User + Claude |
| 2025-01-20 | **v2.0 업데이트** - Phase 0 추가, Phase 1/2 수정, 프레임워크 v2.0 반영<br>• Phase 0: GR 프레임워크 기반 설계 (완료)<br>• Layer 0 신설, Layer 7 확장 (AI 워크로드)<br>• Zone 0 세분화 (0-A: Untrusted, 0-B: Trusted Partner)<br>• Domain T (Tech Stack), Domain I (Interface) 추가<br>• Function Tags 280+ (기존 210+에서 70개 추가)<br>• 하이브리드 DB 아키텍처 (PostgreSQL + Neo4j + Pinecone)<br>• 2-Tier 데이터 모델 (Product Master + Component Archetypes) | Claude Code |
| 2025-01-20 | **v2.1 업데이트** - LLM 전략 명확화 및 취약점 관리 통합<br>• Phase 0-2 LLM 전략: 외부 LLM API 자유 사용 (연 $1K)<br>• 고객 배포 전략: Direct Query 80% + AI-Assisted 20%<br>• Phase 2 취약점 관리 범위 추가:<br>  - CVE 데이터베이스 (100K+ 레코드)<br>  - MITRE ATT&CK 통합 (WHERE + HOW)<br>  - Attack Path 시뮬레이션 (Neo4j)<br>  - AI 기반 추론 시스템 (DB + Web Search 교차 검증) | Claude Code |
| 2025-01-20 | **v2.2 업데이트** - Phase 2 세분화 및 제품 우선순위, 기간 표현 추상화<br>• Phase 2 단계별 목표 세분화:<br>  - Phase 2-1: 100-300개 핵심 제품 (자동진단 솔루션 대상 우선)<br>  - Phase 2-2: 1,000개 제품 (확장)<br>  - Phase 2-3: 10,000개 제품 (전체)<br>• 작업 순서: "Week 1/2/3" → "1단계/2단계/3단계"로 추상화 | Claude Code |

---

## 📞 추가 지시사항 요청 방법

사용자가 새로운 룰이나 지침을 제시할 경우, 이 문서에 자동으로 추가합니다.

**추가 시 포함 사항**:
- 지시 내용
- 적용 범위
- 예시 (필요 시)
- 변경 이력 업데이트

---

**문서 끝**
