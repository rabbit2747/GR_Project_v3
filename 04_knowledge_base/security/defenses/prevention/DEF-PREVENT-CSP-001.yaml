# GR Atom: Content Security Policy
identity:
  id: "DEF-PREVENT-CSP-001"
  name: "Content Security Policy"
  normalization:
    normalized_name: "content_security_policy"
    normalization_version: "1.0"
  aliases:
    - "CSP"
    - "CSP Header"
    - "콘텐츠 보안 정책"

classification:
  domain: security
  type: control
  abstraction_level: 3
  gr_coordinates:
    layer: "L7"
    zone: "Z1"
    tags: ["P", "XSS"]

definition:
  what: |
    브라우저에서 실행 가능한 리소스의 출처를 제한하는 HTTP 보안 헤더.
    스크립트, 스타일, 이미지 등 각 리소스 유형별로 허용된 출처만 지정하여
    악의적인 콘텐츠의 로드와 실행을 차단한다.
  why: |
    XSS 공격이 성공하더라도 CSP를 통해 인라인 스크립트 실행을 차단하고,
    외부 악성 스크립트의 로드를 방지할 수 있다. CSP는 심층 방어의 중요한 계층으로,
    다른 방어 기법이 실패했을 때 2차 방어선 역할을 한다.
  how: |
    1. Content-Security-Policy HTTP 응답 헤더를 설정한다.
    2. default-src 'self' 를 기본 정책으로 설정한다.
    3. script-src, style-src, img-src 등 리소스별 허용 출처를 명시한다.
    4. 인라인 스크립트를 제거하고 nonce 또는 hash 기반 허용 정책을 사용한다.
    5. report-uri 또는 report-to를 설정하여 위반 사항을 모니터링한다.

relations:
  structural:
    is_a: ["TECH-CONCEPT-DEFENSE-001"]
  causal:
    prevents: ["ATK-INJECT-XSS-001"]
  applicability:
    applies_to:
      - "INFRA-APP-WEBAPP-001"

properties:
  technical:
    implementation:
      - "Content-Security-Policy HTTP header"
      - "CSP nonce-based policy"
      - "CSP hash-based policy"
      - "CSP report-only mode for testing"
  security:
    effectiveness: "HIGH"

metadata:
  trust:
    source: official
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      Content Security Policy(CSP)는 브라우저에서 실행 가능한 리소스의 출처를 제한하는
      HTTP 보안 헤더이다. 스크립트, 스타일, 이미지 등의 허용 출처를 명시하여
      XSS 공격의 영향을 최소화하는 심층 방어 계층이다.
    search_keywords:
      - "content security policy"
      - "CSP"
      - "CSP header"
      - "script-src"
      - "XSS mitigation"
      - "콘텐츠 보안 정책"
    related_queries:
      - "CSP 헤더 설정 방법"
      - "CSP nonce와 hash 사용법"
      - "XSS 방어를 위한 CSP 정책 구성"
