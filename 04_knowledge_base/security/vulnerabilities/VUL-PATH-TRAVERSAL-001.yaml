# GR Atom: Path Traversal Vulnerability
identity:
  id: "VUL-PATH-TRAVERSAL-001"
  name: "Path Traversal Vulnerability"
  normalization:
    normalized_name: "path traversal vulnerability"
    normalization_version: "1.0"
  aliases:
    - "Directory Traversal"
    - "Path Traversal Attack"
    - "Dot-Dot-Slash Attack"
    - "../ Attack"
    - "CWE-22"

classification:
  domain: security
  type: vulnerability
  is_infrastructure: false
  abstraction_level: 3
  gr_coordinates:
    layer: "L7"
    zone: "Z2"
    atom_tags: ["AUTHN", "AUTHZ", "EXEC", "EXFIL", "PATH", "PENTEST", "WINDOWS"]

definition:
  what: |
    경로 순회 취약점(CWE-22)은 애플리케이션이 파일 시스템 경로를 구성할 때 사용자 입력을
    적절히 검증하지 않아, 공격자가 의도된 디렉토리 범위를 벗어나 임의의 파일에 접근할 수
    있는 보안 결함이다. "../"(dot-dot-slash) 시퀀스나 절대 경로를 이용하여 웹 루트
    디렉토리 외부의 시스템 파일, 설정 파일, 소스 코드 등을 읽거나 경우에 따라
    쓸 수 있다. URL 인코딩, 이중 인코딩, 유니코드 정규화 등 다양한 우회 기법이 존재한다.
  why: |
    경로 순회 취약점은 서버의 파일 시스템에 대한 무단 접근을 허용하여 민감한 정보 유출,
    소스 코드 노출, 설정 파일 탈취, 인증 정보 획득 등 심각한 결과를 초래한다.
    쓰기 권한이 있는 경우 웹셸 업로드를 통한 원격 코드 실행까지 가능하다.
    이 취약점은 파일 다운로드, 이미지 로딩, 템플릿 렌더링, 로그 파일 뷰어 등
    파일 시스템 경로를 다루는 모든 기능에서 발생할 수 있어 공격 표면이 넓다.
  how: |
    - 발생 조건: 파일 이름/경로를 사용자 입력에서 직접 가져오는 경우,
      파일 다운로드/업로드 기능에서 경로 검증 미흡,
      입력값에 대한 정규화(canonicalization) 미실시,
      화이트리스트 기반 검증 대신 블랙리스트 사용,
      chroot/jail 미설정으로 파일 시스템 접근 범위 미제한
    - 탐지 방법: 파일 경로 파라미터에 "../" 시퀀스 삽입 테스트,
      URL 인코딩(%2e%2e%2f), 이중 인코딩(%252e%252e%252f),
      널 바이트 삽입(%00), 유니코드 인코딩(..%c0%af) 등 다양한 우회 기법 시도,
      알려진 시스템 파일(/etc/passwd, C:\Windows\win.ini) 접근 시도
    - 도구: Burp Suite Intruder, OWASP ZAP, DotDotPwn,
      wfuzz, 커스텀 경로 순회 페이로드 리스트

relations:
  structural:
    is_a: ["TECH-CONCEPT-VULNERABILITY-001"]
  associative:
  applicability:
    applies_to:
      - "파일 다운로드 기능"
      - "파일 업로드 기능"
      - "이미지/리소스 로딩"
      - "템플릿 렌더링 엔진"
      - "로그 파일 뷰어"
      - "파일 관리 인터페이스"

properties:
  security:
    cwe_id: "CWE-22"
    owasp: "A01:2021"
    cvss_base: 7.5
    severity: "High"
    impact:
      confidentiality: "High"
      integrity: "Low"
      availability: "None"
    attack_vector: "Network"
    attack_complexity: "Low"

metadata:
  trust:
    source: official
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      Path Traversal Vulnerability (CWE-22)는 파일 경로 입력값 검증 미흡으로
      공격자가 의도된 디렉토리 범위를 벗어나 임의 파일에 접근할 수 있는 취약점이다.
      "../" 시퀀스를 이용한 디렉토리 탈출로 민감 파일 유출이 가능하다.
    search_keywords:
      - "path traversal"
      - "directory traversal"
      - "CWE-22"
      - "dot-dot-slash"
      - "LFI"
      - "local file inclusion"
      - "file access vulnerability"
      - "경로 순회"
      - "디렉토리 탈출"
    related_queries:
      - "경로 순회 취약점이란 무엇인가?"
      - "경로 순회 공격을 어떻게 방어하는가?"
      - "경로 순회 우회 기법에는 어떤 것들이 있는가?"
      - "파일 경로 입력값 검증 모범 사례는?"
