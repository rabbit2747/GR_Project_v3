# GR Atom: SSRF Vulnerability
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "VUL-SSRF-001"
  name: "Server-Side Request Forgery (SSRF) Vulnerability"
  normalization:
    normalized_name: "ssrf server side request forgery vulnerability"
    normalization_version: "1.0"
  aliases:
    - "SSRF 취약점"
    - "서버 측 요청 위조 취약점"
    - "Server-Side Request Forgery Flaw"

classification:
  domain: security
  type: vulnerability
  is_infrastructure: false
  abstraction_level: 3
  gr_coordinates:
    layer: "L7"
    zone: "Z2"
    atom_tags: ["SSRF", "WEB"]

definition:
  what: |
    SSRF 취약점은 서버 측 애플리케이션이 사용자가 제공한 URL을 검증 없이
    요청하여, 공격자가 서버의 네트워크 위치를 악용해 내부 리소스에 접근할 수
    있는 보안 결함이다. CWE-918에 해당한다.
  why: |
    OWASP Top 10 2021에서 A10에 신규 진입한 취약점으로, 클라우드 환경에서
    특히 치명적이다. AWS/GCP/Azure 메타데이터 API를 통해 IAM 자격증명을
    탈취하여 전체 클라우드 인프라를 장악할 수 있다.
  how: |
    1. URL 입력을 받는 서버 기능 존재 (이미지 로드, URL 프리뷰, 웹훅)
    2. 서버가 사용자 제공 URL에 대한 검증/제한 미적용
    3. 공격자가 내부 IP(127.0.0.1, 169.254.169.254 등)를 URL로 전달
    4. 서버가 내부 네트워크로 요청을 보내 민감 정보 반환
    5. IP 표기법 변환, DNS Rebinding 등으로 필터 우회 시도
    6. Blind SSRF는 응답 없이 내부 포트 스캔이나 서비스 탐지에 활용

relations:
  structural:
    is_a: ["TECH-CONCEPT-VULNERABILITY-001"]
  causal:
    exploited_by:
      - "ATK-SERVER-SSRF-001"  # SSRF 공격 기법
  applicability:
    applies_to:
      - "INFRA-APP-WEBAPP-001"
      - "INFRA-APP-API-001"

properties:
  security:
    cwe_id: "CWE-918"
    owasp: "A10:2021"
    cvss_base: 8.6
    impact:
      confidentiality: "HIGH - 내부 데이터/자격증명 유출"
      integrity: "MEDIUM - 내부 서비스 조작"
      availability: "LOW"
  countermeasures:
    primary:
      - name: "URL 화이트리스트"
        description: "허용된 도메인/IP만 요청 허용"
        effectiveness: "HIGH"
      - name: "내부 IP 대역 차단"
        description: "사설 IP, 루프백, 메타데이터 IP 차단"
        effectiveness: "HIGH"
    secondary:
      - name: "DNS Resolution 제어"
        effectiveness: "MEDIUM"
      - name: "응답 필터링"
        effectiveness: "MEDIUM"

metadata:
  trust:
    source: official
    references:
      - "CWE-918: Server-Side Request Forgery (SSRF)"
      - "OWASP A10:2021 - Server-Side Request Forgery"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      SSRF 취약점(CWE-918)은 서버가 사용자 제공 URL을 검증 없이 요청하여
      내부 리소스에 접근 가능한 보안 결함이다. 클라우드 메타데이터 API로
      자격증명 탈취가 가능하다. URL 화이트리스트와 내부 IP 차단으로 방어한다.
      OWASP A10:2021, CVSS 8.6.
    search_keywords:
      - "SSRF 취약점"
      - "Server-Side Request Forgery"
      - "CWE-918"
      - "서버 측 요청 위조"
      - "클라우드 SSRF"
    related_queries:
      - "SSRF 취약점이란?"
      - "SSRF 방어 방법"
      - "OWASP A10:2021 대응 방안"
      - "클라우드 환경 SSRF 위험"
