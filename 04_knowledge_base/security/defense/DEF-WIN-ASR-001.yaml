# GR Atom: Attack Surface Reduction (ASR) Rules
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "DEF-WIN-ASR-001"
  name: "Attack Surface Reduction (ASR) Rules"
  normalization:
    normalized_name: "asr attack surface reduction rules windows defender"
    normalization_version: "1.0"
  aliases:
    - "ASR 규칙"
    - "공격 표면 감소"
    - "Windows Defender ASR"

classification:
  domain: security
  type: control
  abstraction_level: 2
  gr_coordinates:
    layer: "L5"
    zone: "Zone3"
    tags: ["DEF", "WIN", "ENDPOINT"]

definition:
  what: |
    일반적인 공격 기법에서 사용되는 동작을 차단하여
    엔드포인트 공격 표면을 줄이는 Windows Defender 기능이다.
  why: |
    랜섬웨어, 악성 스크립트 등을 차단한다.
    취약한 동작 패턴을 제한한다.
  how: |
    1. ASR 규칙 선택
    2. GPO 또는 Intune으로 배포
    3. 감사 모드로 테스트
    4. 차단 모드로 전환

relations:
  structural:
    is_a:
      - "DEF-DETECT-XDR-001"
    related_to:
      - "ATK-MITRE-T1059-001"
      - "ATK-MALWARE-RANSOMWARE-001"

properties:
  technical:
    requirements:
      - "Windows 10/11"
      - "Windows Defender 활성화"
      - "클라우드 보호 권장"
    key_rules:
      - name: "Block Office from creating child processes"
        guid: "D4F940AB-401B-4EFC-AADC-AD5F3C50688A"
        mitigates: "Office 매크로 악용"
      - name: "Block executable content download via email"
        guid: "BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550"
        mitigates: "이메일 악성 첨부파일"
      - name: "Block credential stealing from LSASS"
        guid: "9E6C4E1F-7D60-472F-BA1A-A39EF669E4B2"
        mitigates: "Mimikatz 공격"
      - name: "Block process creations from PSExec and WMI"
        guid: "D1E49AAC-8F56-4280-B9BA-993A6D77406C"
        mitigates: "횡적 이동"
      - name: "Use advanced ransomware protection"
        guid: "C1DB55AB-C21A-4637-BB3F-A12568109D35"
        mitigates: "랜섬웨어"
    modes:
      - "Disabled (0)"
      - "Block (1)"
      - "Audit (2)"
      - "Warn (6)"
    deployment:
      gpo: "관리 템플릿 > Windows 구성 요소 > Microsoft Defender Antivirus > ASR"
      intune: "Endpoint Security > ASR"
      powershell: "Set-MpPreference -AttackSurfaceReductionRules_Ids <GUID> -AttackSurfaceReductionRules_Actions Enabled"
    monitoring:
      - "Event ID 1121/1122 (ASR 규칙)"
      - "Microsoft Defender ATP"
      - "Windows Event Log"
    best_practices:
      - "감사 모드부터 시작"
      - "예외 규칙 최소화"
      - "지속적 모니터링"

metadata:
  trust:
    source: official
    references:
      - "Microsoft ASR Documentation"
      - "Windows Defender"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      ASR 규칙은 Office 매크로, 랜섬웨어 등 일반적인 공격 동작을
      차단하여 공격 표면을 줄이는 Windows Defender 기능이다.
    search_keywords:
      - "ASR"
      - "Attack Surface Reduction"
      - "Windows Defender"
      - "엔드포인트 보안"
    related_queries:
      - "랜섬웨어 방지"
      - "Office 보안"
      - "엔드포인트 보호"
