# GR Atom: Subdomain Takeover
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "ATK-WEB-SUBDOMAIN-TAKEOVER-001"
  name: "Subdomain Takeover"
  normalization:
    normalized_name: "subdomain takeover dangling dns cname hijack"
    normalization_version: "1.0"
  aliases:
    - "서브도메인 탈취"
    - "Dangling DNS"
    - "CNAME Hijacking"

classification:
  domain: security
  type: attack
  abstraction_level: 2
  gr_coordinates:
    layer: "L4"
    zone: "Zone1"
    tags: ["ATK", "WEB", "DNS"]

definition:
  what: |
    서브도메인 탈취는 더 이상 사용되지 않는 DNS 레코드가 외부 서비스를
    가리킬 때 공격자가 해당 서비스에서 컨텐츠를 호스팅하는 공격이다.
  why: |
    신뢰할 수 있는 도메인에서 악성 컨텐츠를 호스팅할 수 있다.
    쿠키 탈취, 피싱, 평판 손상이 가능하다.
  how: |
    1. Dangling DNS 레코드 발견
    2. 가리키는 서비스에서 계정 생성
    3. 해당 서브도메인 클레임
    4. 악성 컨텐츠 호스팅

relations:
  structural:
    is_a:
      - "GR-SEC-VULN-001"
    related_to:
      - "ATK-NET-DNS-001"

properties:
  technical:
    vulnerable_services:
      - name: "GitHub Pages"
        indicator: "404 There isn't a GitHub Pages site here"
      - name: "Heroku"
        indicator: "No such app"
      - name: "AWS S3"
        indicator: "NoSuchBucket"
      - name: "Azure"
        indicator: "NXDOMAIN"
      - name: "Shopify"
        indicator: "Sorry, this shop is currently unavailable"
      - name: "Fastly"
        indicator: "Fastly error: unknown domain"
    discovery_methods:
      - "DNS 레코드 열거"
      - "CNAME 레코드 확인"
      - "HTTP 응답 분석"
      - "자동화 도구 (subjack, nuclei)"
    attack_impact:
      - "쿠키 탈취 (같은 도메인)"
      - "피싱"
      - "악성코드 배포"
      - "SEO 스팸"
      - "평판 손상"
    discovery_tools:
      - "subjack"
      - "nuclei"
      - "can-i-take-over-xyz"
      - "dnsrecon"
      - "amass"
    prevention:
      - "정기적 DNS 감사"
      - "사용하지 않는 레코드 삭제"
      - "서비스 해지 시 DNS 정리"
      - "와일드카드 DNS 주의"
      - "DNS 모니터링"
    remediation:
      - "Dangling 레코드 삭제"
      - "서비스 재등록"
      - "모니터링 설정"

metadata:
  trust:
    source: official
    references:
      - "OWASP Subdomain Takeover"
      - "Can I Take Over XYZ"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      서브도메인 탈취는 Dangling DNS 레코드를 악용한다. 사용하지 않는
      DNS 레코드 삭제, 정기 감사로 방어한다.
    search_keywords:
      - "서브도메인 탈취"
      - "Dangling DNS"
      - "CNAME"
      - "DNS 하이재킹"
    related_queries:
      - "DNS 보안"
      - "클라우드 서비스 DNS"
      - "도메인 탈취"
