# GR Atom: Silver Ticket Attack
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "ATK-WIN-SILVER-TICKET-001"
  name: "Silver Ticket Attack"
  normalization:
    normalized_name: "silver ticket attack kerberos tgs forged service"
    normalization_version: "1.0"
  aliases:
    - "Silver Ticket 공격"
    - "서비스 티켓 위조"
    - "TGS 위조"

classification:
  domain: security
  type: technique
  is_infrastructure: false
  abstraction_level: 2
  gr_coordinates:
    layer: "L5"
    zone: "Z4"
    atom_tags: ["AD", "KERBEROS", "WINDOWS"]

definition:
  what: |
    서비스 계정의 NTLM 해시를 사용하여 특정 서비스에 대한
    Kerberos 서비스 티켓(TGS)을 위조하는 공격이다.
  why: |
    특정 서비스에 무단 접근한다.
    DC를 거치지 않아 탐지가 어렵다.
  how: |
    1. 서비스 계정 해시 획득
    2. 위조 서비스 티켓 생성
    3. 타겟 서비스 접근
    4. 권한 남용

relations:
  structural:
    is_a:
      - "ATK-WIN-GOLDEN-TICKET-001"

properties:
  technical:
    versus_golden_ticket:
      - "Golden: TGT 위조 (전체 도메인)"
      - "Silver: TGS 위조 (특정 서비스)"
    required_info:
      - "서비스 계정 NTLM 해시"
      - "도메인 SID"
      - "타겟 SPN"
    common_targets:
      - name: "CIFS"
        spn: "cifs/server.corp.local"
        access: "파일 공유"
      - name: "HTTP"
        spn: "http/server.corp.local"
        access: "웹 애플리케이션"
      - name: "MSSQLSvc"
        spn: "MSSQLSvc/server.corp.local:1433"
        access: "데이터베이스"
      - name: "HOST"
        spn: "host/server.corp.local"
        access: "WMI, PSRemoting"
    tools:
      mimikatz: 'kerberos::golden /sid:S-1-5-21-... /domain:corp.local /target:server /service:cifs /rc4:<hash> /user:admin'
      ticketer: "ticketer.py -nthash <hash> -domain-sid S-1-5-21-... -domain corp.local -spn cifs/server admin"
    advantages:
      - "DC 로그에 기록 안됨"
      - "특정 서비스만 필요"
      - "네트워크 트래픽 적음"
    detection:
      - "TGS 없이 서비스 접근"
      - "서비스 로그 분석"
      - "비정상 세션"
    mitigation:
      - "서비스 계정 관리"
      - "Managed Service Accounts"
      - "패스워드 정기 변경"
      - "서비스 로그 모니터링"

metadata:
  trust:
    source: official
    references:
      - "MITRE ATT&CK T1558.002"
      - "ADSecurity Silver Ticket"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      Silver Ticket은 서비스 계정 해시로 특정 서비스에 대한
      Kerberos TGS를 위조하는 공격이다.
    search_keywords:
      - "Silver Ticket"
      - "TGS 위조"
      - "서비스 티켓"
      - "Kerberos"
    related_queries:
      - "Golden Ticket"
      - "Kerberos 공격"
      - "AD 공격"
