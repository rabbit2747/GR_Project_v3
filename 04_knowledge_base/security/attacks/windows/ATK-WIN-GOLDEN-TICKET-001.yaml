# GR Atom: Golden Ticket Attack
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "ATK-WIN-GOLDEN-TICKET-001"
  name: "Golden Ticket Attack"
  normalization:
    normalized_name: "golden ticket kerberos krbtgt domain persistence"
    normalization_version: "1.0"
  aliases:
    - "Golden Ticket"
    - "골든 티켓"
    - "KRBTGT 공격"

classification:
  domain: security
  type: technique
  is_infrastructure: false
  abstraction_level: 2
  gr_coordinates:
    layer: "L7"
    zone: "Z1"
    atom_tags: ["ATK", "WIN", "KERBEROS"]

definition:
  what: |
    Golden Ticket은 KRBTGT 계정의 해시를 사용하여 위조된 TGT를 생성하고
    도메인 내 모든 리소스에 무제한 접근하는 공격이다.
  why: |
    도메인 완전 장악을 의미한다. KRBTGT 해시가 유출되면
    공격자가 임의의 사용자로 인증할 수 있다.
  how: |
    1. 도메인 컨트롤러 접근
    2. KRBTGT 해시 추출 (DCSync)
    3. TGT 위조 생성
    4. 도메인 전체 접근

relations:
  structural:
    is_a:
      - "ATK-MITRE-CREDENTIAL-001"
    requires:
      - "ATK-MITRE-T1003-001"

properties:
  technical:
    prerequisites:
      - "KRBTGT 계정 NTLM 해시"
      - "도메인 SID"
      - "도메인 FQDN"
    attack_steps:
      - step: "1. KRBTGT 해시 획득"
        methods: ["DCSync", "NTDS.dit 추출"]
      - step: "2. TGT 생성"
        tool: "Mimikatz kerberos::golden"
      - step: "3. 티켓 주입"
        command: "kerberos::ptt ticket.kirbi"
      - step: "4. 리소스 접근"
        result: "도메인 전체 접근"
    mimikatz_command: |
      kerberos::golden /user:Administrator /domain:corp.local
      /sid:S-1-5-21-... /krbtgt:HASH /ptt
    persistence:
      - "티켓 기본 수명: 10년"
      - "KRBTGT 변경 전까지 유효"
      - "DC 오프라인에서도 생성 가능"
    detection:
      - "비정상 TGT 수명"
      - "DC가 발급하지 않은 티켓"
      - "그룹 멤버십 불일치"
      - "이벤트 ID 4769 이상"
    remediation:
      - "KRBTGT 비밀번호 2회 변경"
        note: "12시간 간격으로 2회"
      - "모든 Kerberos 티켓 무효화"
      - "침해 범위 조사"
    prevention:
      - "도메인 관리자 계정 보호"
      - "DC 접근 제한"
      - "정기적 KRBTGT 변경"
      - "PAW 사용"

metadata:
  trust:
    source: official
    references:
      - "MITRE ATT&CK T1558.001"
      - "Mimikatz Wiki"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      Golden Ticket은 KRBTGT 해시로 TGT를 위조하는 공격이다. 도메인 완전 장악을
      의미하며 KRBTGT 2회 변경으로 무효화한다.
    search_keywords:
      - "Golden Ticket"
      - "KRBTGT"
      - "Kerberos"
      - "도메인 장악"
    related_queries:
      - "DCSync"
      - "Mimikatz"
      - "AD 침해 복구"
