# GR Atom: Kerberoasting Attack
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "ATK-WIN-KERBEROASTING-001"
  name: "Kerberoasting Attack"
  normalization:
    normalized_name: "kerberoasting kerberos spn service ticket cracking"
    normalization_version: "1.0"
  aliases:
    - "Kerberoasting"
    - "커버로스팅"
    - "서비스 티켓 크래킹"

classification:
  domain: security
  type: technique
  is_infrastructure: false
  abstraction_level: 2
  gr_coordinates:
    layer: "L7"
    zone: "Z1"
    atom_tags: ["ATK", "WIN", "KERBEROS"]

definition:
  what: |
    Kerberoasting은 서비스 계정의 Kerberos TGS 티켓을 요청하고
    오프라인에서 비밀번호를 크래킹하는 공격이다.
  why: |
    도메인 사용자 권한만으로 공격이 가능하다.
    서비스 계정은 종종 권한이 높고 비밀번호가 약하다.
  how: |
    1. SPN이 설정된 계정 열거
    2. TGS 티켓 요청
    3. 티켓에서 해시 추출
    4. 오프라인 크래킹

relations:
  structural:
    is_a:
      - "ATK-MITRE-CREDENTIAL-001"

properties:
  technical:
    attack_steps:
      - step: "1. SPN 열거"
        command: "setspn -T domain -Q */*"
        alternative: "Get-ADUser -Filter * -Properties servicePrincipalName"
      - step: "2. 티켓 요청"
        tools: ["Rubeus", "Invoke-Kerberoast"]
      - step: "3. 해시 추출"
        format: "$krb5tgs$23$*..."
      - step: "4. 크래킹"
        tools: ["hashcat -m 13100", "john"]
    requirements:
      - "도메인 사용자 계정"
      - "네트워크 연결"
    tools:
      - name: "Rubeus"
        command: "Rubeus.exe kerberoast"
      - name: "Invoke-Kerberoast"
        source: "PowerSploit"
      - name: "GetUserSPNs.py"
        source: "Impacket"
    target_identification:
      high_value:
        - "관리자 그룹 멤버"
        - "권한 있는 서비스 계정"
        - "SQL Server 계정"
      indicators:
        - "SPN 설정"
        - "비활성 계정"
        - "오래된 비밀번호"
    detection:
      - "이벤트 ID 4769 (TGS 요청)"
      - "RC4 암호화 요청"
      - "다수의 TGS 요청"
    prevention:
      - "강력한 서비스 계정 비밀번호 (25자+)"
      - "gMSA (Group Managed Service Accounts)"
      - "AES 암호화 강제"
      - "권한 있는 계정 SPN 제거"
      - "정기적 비밀번호 변경"

metadata:
  trust:
    source: official
    references:
      - "MITRE ATT&CK T1558.003"
      - "Harmj0y Kerberoasting"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      Kerberoasting은 서비스 티켓을 크래킹하는 AD 공격이다. 도메인 사용자로
      가능하며 gMSA, 강력한 비밀번호, AES로 방어한다.
    search_keywords:
      - "Kerberoasting"
      - "SPN"
      - "서비스 티켓"
      - "AD 공격"
    related_queries:
      - "Kerberos 공격"
      - "서비스 계정 보안"
      - "gMSA"
