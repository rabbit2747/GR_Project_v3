# GR Atom: Insecure Deserialization
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "ATK-SERVER-DESER-001"
  name: "Insecure Deserialization"
  normalization:
    normalized_name: "insecure deserialization unsafe deserialization"
    normalization_version: "1.0"
  aliases:
    - "안전하지 않은 역직렬화"
    - "Deserialization Attack"
    - "Object Injection"

classification:
  domain: security
  type: technique
  abstraction_level: 3
  gr_coordinates:
    layer: "L7"
    zone: "Zone2"
    tags: ["EXPLOIT"]

definition:
  what: |
    Insecure Deserialization은 신뢰할 수 없는 직렬화된 데이터를
    역직렬화할 때 발생하는 취약점이다. 악성 객체를 주입하여
    원격 코드 실행(RCE), 권한 상승, DoS를 유발할 수 있다.
  why: |
    원격 코드 실행이 가능한 치명적 취약점이다. Java, PHP, Python, .NET 등
    대부분의 언어에서 발생 가능하며, 탐지가 매우 어렵다.
  how: |
    1. 직렬화된 데이터 전송 지점 식별 (쿠키, 파라미터, API)
    2. 직렬화 형식 파악 (Java ObjectInputStream, PHP serialize 등)
    3. 악성 가젯 체인(Gadget Chain) 구성
    4. 조작된 직렬화 데이터 전송
    5. 서버에서 역직렬화 시 악성 코드 실행

relations:
  structural:
    is_a: ["TECH-CONCEPT-SERVER-ATTACK-001"]
  causal:
    enables:
      - "ATK-INJECT-CMD-001"  # RCE
  applicability:
    applies_to:
      - "INFRA-APP-WAS-001"
      - "INFRA-APP-API-001"

properties:
  technical:
    affected_languages:
      - name: "Java"
        format: "ObjectInputStream"
        indicator: "rO0AB (base64), aced0005 (hex)"
        tools: ["ysoserial"]
      - name: "PHP"
        format: "serialize()/unserialize()"
        indicator: "O:4:\"User\":2:{...}"
        tools: ["PHPGGC"]
      - name: "Python"
        format: "pickle"
        indicator: "\\x80\\x03"
        tools: ["custom"]
      - name: ".NET"
        format: "BinaryFormatter"
        tools: ["ysoserial.net"]
    impact_types:
      - "Remote Code Execution (RCE)"
      - "Privilege Escalation"
      - "Denial of Service"
      - "Data Tampering"
  security:
    impact:
      confidentiality: "CRITICAL"
      integrity: "CRITICAL"
      availability: "HIGH"
    cvss_base: 9.8
    cwe_id: "CWE-502"
    owasp: "A08:2021 - Software and Data Integrity Failures"
  countermeasures:
    primary:
      - name: "역직렬화 회피"
        description: "JSON 등 안전한 형식 사용"
        effectiveness: "HIGH"
      - name: "화이트리스트 클래스 필터링"
        effectiveness: "HIGH"
    secondary:
      - name: "무결성 검증 (HMAC)"
        effectiveness: "MEDIUM"
      - name: "격리된 환경에서 역직렬화"
        effectiveness: "MEDIUM"

metadata:
  trust:
    source: official
    references:
      - "OWASP Deserialization Cheat Sheet"
      - "CWE-502"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
    weaponization_risk: high
  ai:
    embedding_text: |
      Insecure Deserialization은 신뢰할 수 없는 직렬화 데이터를 역직렬화할 때
      발생하는 취약점이다. Java(ysoserial), PHP(PHPGGC), Python(pickle)에서
      원격 코드 실행이 가능하다. JSON 등 안전한 형식 사용, 클래스 화이트리스트로 방어한다.
    search_keywords:
      - "Deserialization"
      - "역직렬화"
      - "ysoserial"
      - "Object Injection"
      - "RCE"
    related_queries:
      - "역직렬화 취약점이란?"
      - "ysoserial 사용법"
      - "Java 역직렬화 공격"
