# GR Atom: Server-Side Request Forgery (SSRF)
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "ATK-SERVER-SSRF-001"
  name: "Server-Side Request Forgery (SSRF)"
  normalization:
    normalized_name: "ssrf server side request forgery"
    normalization_version: "1.0"
  aliases:
    - "SSRF"
    - "서버 측 요청 위조"

classification:
  domain: security
  type: technique
  abstraction_level: 3
  gr_coordinates:
    layer: "L7"
    zone: "Zone2"
    tags: ["EXPLOIT", "WEB", "API"]

definition:
  what: |
    SSRF는 서버가 공격자가 지정한 URL로 요청을 보내게 만드는 취약점이다.
    서버의 네트워크 위치를 악용하여 내부 서비스, 메타데이터 API,
    클라우드 자격증명에 접근할 수 있다.
  why: |
    OWASP Top 10 2021 A10에 신규 진입한 취약점으로, 클라우드 환경에서
    특히 치명적이다. AWS metadata API(169.254.169.254)를 통해
    IAM 자격증명을 탈취하여 전체 클라우드 인프라를 장악할 수 있다.
  how: |
    1. URL을 입력받는 기능 식별 (이미지 로드, URL 프리뷰, 웹훅 등)
    2. 내부 IP/도메인을 URL로 전달
    3. 서버가 내부 네트워크로 요청 전송
    4. 내부 서비스 응답을 공격자에게 반환 (또는 Blind SSRF)

relations:
  structural:
    is_a: ["TECH-CONCEPT-SERVER-ATTACK-001"]
  causal:
    enables:
      - "VUL-DATA-EXPOSURE-001"  # 내부 데이터 유출
  conditional:
    requires:
      - "TECH-PROTOCOL-HTTP-001"
  applicability:
    applies_to:
      - "INFRA-APP-WEBAPP-001"
      - "INFRA-APP-API-001"

properties:
  technical:
    attack_types:
      - name: "Basic SSRF"
        description: "응답이 공격자에게 반환"
      - name: "Blind SSRF"
        description: "응답을 볼 수 없지만 내부 요청은 수행"
    common_targets:
      - name: "Cloud Metadata"
        url: "http://169.254.169.254/latest/meta-data/"
        impact: "IAM 자격증명 탈취"
      - name: "Internal Services"
        url: "http://localhost:8080/admin"
        impact: "관리 기능 접근"
      - name: "Internal Network"
        url: "http://192.168.1.1/"
        impact: "네트워크 스캔"
    bypass_techniques:
      - "IP 표기법 변환 (0x7f000001, 2130706433)"
      - "DNS Rebinding"
      - "URL 리다이렉트 활용"
      - "IPv6 (::1)"
      - "URL 인코딩"
  security:
    impact:
      confidentiality: "HIGH - 내부 데이터/자격증명 유출"
      integrity: "MEDIUM - 내부 서비스 조작"
      availability: "LOW"
    cvss_base: 8.6
    mitre_attack:
      technique_id: "T1090"
      tactic: "Command and Control"
    cwe_id: "CWE-918"
    owasp: "A10:2021 - Server-Side Request Forgery"
  countermeasures:
    primary:
      - name: "URL 화이트리스트"
        effectiveness: "HIGH"
      - name: "내부 IP 대역 차단"
        effectiveness: "HIGH"
    secondary:
      - name: "DNS Resolution 제어"
        effectiveness: "MEDIUM"
      - name: "응답 필터링"
        effectiveness: "MEDIUM"

metadata:
  trust:
    source: official
    references:
      - "OWASP SSRF Prevention Cheat Sheet"
      - "CWE-918"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
    weaponization_risk: high
  ai:
    embedding_text: |
      SSRF Server-Side Request Forgery는 서버가 공격자 지정 URL로 요청하게
      만드는 취약점이다. 클라우드 metadata API(169.254.169.254)로 IAM
      자격증명 탈취, 내부 서비스 접근이 가능하다. URL 화이트리스트,
      내부 IP 차단으로 방어한다. OWASP Top 10 2021 A10.
    search_keywords:
      - "SSRF"
      - "Server-Side Request Forgery"
      - "서버 측 요청 위조"
      - "metadata API"
    related_queries:
      - "SSRF란?"
      - "SSRF 공격 방법"
      - "클라우드 SSRF"
