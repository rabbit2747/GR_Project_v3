# GR Atom: Malicious File Upload
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "ATK-SERVER-FILEUPLOAD-001"
  name: "Malicious File Upload"
  normalization:
    normalized_name: "malicious file upload unrestricted file upload webshell"
    normalization_version: "1.0"
  aliases:
    - "악성 파일 업로드"
    - "Unrestricted File Upload"
    - "Web Shell Upload"
    - "파일 업로드 공격"

classification:
  domain: security
  type: technique
  abstraction_level: 3
  gr_coordinates:
    layer: "L7"
    zone: "Z2"
    tags: ["EXPLOIT", "WEB"]

definition:
  what: |
    파일 업로드 기능에 검증이 부족하여 악성 스크립트(웹셸, 악성코드)를
    서버에 업로드하고 실행하는 공격이다. 원격 코드 실행(RCE)으로
    서버를 완전 장악할 수 있다.
  why: |
    웹셸 업로드 시 서버를 완전히 제어할 수 있는 치명적 취약점이다.
    파일 업로드 기능은 대부분의 웹 애플리케이션에 존재하여 공격 면이 넓다.
  how: |
    1. 파일 업로드 기능 식별
    2. 확장자/콘텐츠 검증 우회 (이중 확장자, MIME 변조 등)
    3. 악성 스크립트 파일 업로드 (웹셸)
    4. 업로드된 파일 경로 확인
    5. 파일 접근하여 코드 실행

relations:
  structural:
    is_a: ["TECH-CONCEPT-SERVER-ATTACK-001"]
  causal:
    enables:
      - "ATK-INJECT-CMD-001"  # RCE
  applicability:
    applies_to:
      - "INFRA-APP-WEBAPP-001"
      - "INFRA-APP-WEBSERVER-001"

properties:
  technical:
    bypass_techniques:
      - name: "이중 확장자"
        example: "shell.php.jpg"
      - name: "Null Byte"
        example: "shell.php%00.jpg"
      - name: "MIME Type 변조"
        example: "Content-Type: image/jpeg"
      - name: "대소문자"
        example: ".pHp, .PhP"
      - name: "매직 바이트 삽입"
        example: "GIF89a + PHP code"
      - name: "대체 확장자"
        example: ".php5, .phtml, .phar"
    webshell_types:
      - "PHP Web Shell"
      - "JSP Web Shell"
      - "ASPX Web Shell"
      - "Python Web Shell"
  security:
    impact:
      confidentiality: "CRITICAL"
      integrity: "CRITICAL"
      availability: "HIGH"
    cvss_base: 9.8
    cwe_id: "CWE-434"
    mitre_attack:
      technique_id: "T1105"
      tactic: "Command and Control"
  countermeasures:
    primary:
      - name: "화이트리스트 확장자 검증"
        effectiveness: "HIGH"
      - name: "파일 콘텐츠 검증 (매직 바이트)"
        effectiveness: "HIGH"
      - name: "업로드 디렉토리 실행 권한 제거"
        effectiveness: "HIGH"
    secondary:
      - name: "파일명 랜덤화"
        effectiveness: "MEDIUM"
      - name: "별도 스토리지 저장 (S3 등)"
        effectiveness: "HIGH"

metadata:
  trust:
    source: official
    references:
      - "OWASP Unrestricted File Upload"
      - "CWE-434"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
    weaponization_risk: high
  ai:
    embedding_text: |
      Malicious File Upload은 악성 스크립트(웹셸)를 서버에 업로드하여
      원격 코드를 실행하는 공격이다. 이중 확장자, MIME 변조, Null Byte 등으로
      검증을 우회한다. 화이트리스트 확장자, 콘텐츠 검증, 실행 권한 제거로 방어한다.
    search_keywords:
      - "File Upload"
      - "Web Shell"
      - "웹셸"
      - "파일 업로드 공격"
    related_queries:
      - "파일 업로드 취약점이란?"
      - "웹셸이란?"
      - "파일 업로드 우회 기법"
