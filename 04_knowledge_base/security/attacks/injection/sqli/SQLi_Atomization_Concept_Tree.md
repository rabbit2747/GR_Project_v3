# SQLi 원자화 개념 트리 (Concept Tree for SQLi Atomization)

> **문서 버전**: 1.0
> **작성일**: 2025-01-26
> **목적**: AI 기반 보안 솔루션 구축을 위한 SQLi 관련 지식의 체계적 원자화 계획

---

## 1. 개요

### 1.1 목적

이 문서는 SQL Injection(SQLi) 관련 지식을 원자화하기 위해 필요한 모든 개념을 브레인스토밍하여 정리한 것이다.

SQLi를 완전히 설명하고, AI가 신뢰도 높은 판단을 내릴 수 있도록 하려면 SQLi 자체뿐 아니라 이를 둘러싼 모든 관련 개념들도 함께 원자화되어야 한다.

### 1.2 Depth 기준

| 영역 | 목표 Depth | 근거 |
|------|-----------|------|
| SQLi 공격 기법 | 6~7 | 실제 페이로드 생성/판단에 모든 세부사항 필요 |
| DBMS별 특성 | 5~6 | 함수 문법, 권한, 제약조건까지 알아야 정확한 페이로드 |
| WAF 우회 | 5~6 | 우회 조건과 대안까지 체인으로 연결 |
| HTTP/웹 | 4~5 | 파라미터 위치, 인코딩 규칙 등 실무 수준 |
| 인코딩 | 4~5 | 변환 규칙이 정확해야 우회 페이로드 생성 가능 |
| 네트워크/인프라 | 2~3 | 기본만 (세부는 외부 참조) |

### 1.3 통계 요약

| 브랜치 | 주제 | 최대 Depth | 예상 원자 수 |
|--------|------|-----------|-------------|
| 1 | SQL 언어 기초 | 7 | ~80 |
| 2 | DBMS 시스템 구조 | 6 | ~60 |
| 3 | HTTP 프로토콜 | 6 | ~50 |
| 4 | 인코딩 체계 | 5 | ~35 |
| 5 | 입력 처리 및 검증 | 5 | ~45 |
| 6 | WAF 및 보안 메커니즘 | 5 | ~50 |
| 7 | 공격 방법론 | 5 | ~55 |
| 8 | DAST 구현 | 4 | ~40 |
| 9 | 관련 취약점/개념 | 4 | ~25 |
| **합계** | | | **~440** |

---

## 2. 개념 트리

### Branch 1: SQL 언어 기초

```
SQL 언어
├─── 1. SQL 쿼리 구조
│    ├─── 2. SELECT 문
│    │    ├─── 3. SELECT 절
│    │    │    ├─── 4. 컬럼 지정
│    │    │    ├─── 4. 와일드카드 (*)
│    │    │    ├─── 4. 별칭 (AS)
│    │    │    └─── 4. DISTINCT
│    │    ├─── 3. FROM 절
│    │    │    ├─── 4. 테이블 참조
│    │    │    ├─── 4. JOIN
│    │    │    │    ├─── 5. INNER JOIN
│    │    │    │    ├─── 5. LEFT/RIGHT JOIN
│    │    │    │    └─── 5. JOIN 조건
│    │    │    └─── 4. 서브쿼리 (인라인 뷰)
│    │    ├─── 3. WHERE 절
│    │    │    ├─── 4. 비교 조건
│    │    │    │    ├─── 5. 등호 (=)
│    │    │    │    ├─── 5. 부등호 (<, >, <=, >=, <>)
│    │    │    │    ├─── 5. LIKE 패턴
│    │    │    │    │    ├─── 6. % 와일드카드
│    │    │    │    │    └─── 6. _ 와일드카드
│    │    │    │    ├─── 5. IN 연산자
│    │    │    │    ├─── 5. BETWEEN
│    │    │    │    └─── 5. IS NULL / IS NOT NULL
│    │    │    ├─── 4. 논리 조건
│    │    │    │    ├─── 5. AND
│    │    │    │    │    └─── 6. 단락 평가 (Short-circuit)
│    │    │    │    ├─── 5. OR
│    │    │    │    │    └─── 6. 항상 참 조건 (1=1)
│    │    │    │    └─── 5. NOT
│    │    │    └─── 4. 서브쿼리 조건
│    │    │         ├─── 5. EXISTS
│    │    │         └─── 5. 스칼라 서브쿼리
│    │    ├─── 3. GROUP BY 절
│    │    │    └─── 4. 집계 함수
│    │    │         ├─── 5. COUNT()
│    │    │         ├─── 5. SUM()
│    │    │         ├─── 5. MAX()/MIN()
│    │    │         └─── 5. GROUP_CONCAT() (MySQL)
│    │    ├─── 3. HAVING 절
│    │    ├─── 3. ORDER BY 절
│    │    │    ├─── 4. 컬럼명 정렬
│    │    │    ├─── 4. 컬럼 번호 정렬
│    │    │    │    └─── 5. 컬럼 수 추론 기법
│    │    │    ├─── 4. ASC/DESC
│    │    │    └─── 4. 다중 컬럼 정렬
│    │    └─── 3. LIMIT/OFFSET
│    │         ├─── 4. LIMIT 절
│    │         ├─── 4. OFFSET 절
│    │         └─── 4. DBMS별 차이
│    │              ├─── 5. MySQL: LIMIT n, m
│    │              ├─── 5. MSSQL: TOP / OFFSET-FETCH
│    │              ├─── 5. Oracle: ROWNUM
│    │              └─── 5. PostgreSQL: LIMIT/OFFSET
│    │
│    ├─── 2. INSERT 문
│    │    ├─── 3. VALUES 절
│    │    ├─── 3. 다중 행 삽입
│    │    └─── 3. INSERT ... SELECT
│    │
│    ├─── 2. UPDATE 문
│    │    ├─── 3. SET 절
│    │    └─── 3. WHERE 조건
│    │
│    ├─── 2. DELETE 문
│    │    └─── 3. WHERE 조건
│    │
│    └─── 2. UNION 연산자
│         ├─── 3. UNION vs UNION ALL
│         │    ├─── 4. 중복 제거 여부
│         │    └─── 4. 성능 차이
│         ├─── 3. 컬럼 수 일치 규칙
│         │    ├─── 4. 컬럼 수 불일치 에러
│         │    │    ├─── 5. MySQL 에러 메시지
│         │    │    ├─── 5. MSSQL 에러 메시지
│         │    │    ├─── 5. PostgreSQL 에러 메시지
│         │    │    └─── 5. Oracle 에러 메시지
│         │    └─── 4. 컬럼 수 추론 방법
│         │         ├─── 5. ORDER BY 증가법
│         │         ├─── 5. UNION SELECT NULL 증가법
│         │         └─── 5. 이진 탐색 최적화
│         ├─── 3. 데이터 타입 호환
│         │    ├─── 4. 암묵적 형변환
│         │    └─── 4. NULL의 타입 유연성
│         └─── 3. 출력 컬럼 위치 확인
│              ├─── 4. 숫자 마커 기법 (1,2,3,4)
│              └─── 4. 문자열 마커 기법 ('a','b','c')
│
├─── 1. SQL 리터럴
│    ├─── 2. 문자열 리터럴
│    │    ├─── 3. 작은따옴표 (')
│    │    │    ├─── 4. 이스케이프 방법
│    │    │    │    ├─── 5. 두 번 쓰기 ('')
│    │    │    │    ├─── 5. 백슬래시 (\')
│    │    │    │    │    └─── 6. DBMS별 지원 여부
│    │    │    │    │         ├─── 7. MySQL: 기본 지원
│    │    │    │    │         ├─── 7. PostgreSQL: standard_conforming_strings
│    │    │    │    │         └─── 7. MSSQL: 미지원
│    │    │    │    └─── 5. 인코딩 우회
│    │    │    └─── 4. 문자열 컨텍스트 탈출
│    │    │         ├─── 5. 따옴표 닫기
│    │    │         ├─── 5. 조건 삽입
│    │    │         └─── 5. 주석으로 나머지 제거
│    │    ├─── 3. 큰따옴표 (")
│    │    │    ├─── 4. MySQL: 문자열로 사용 가능
│    │    │    ├─── 4. MSSQL: 식별자용
│    │    │    └─── 4. Oracle: 식별자용
│    │    └─── 3. 문자열 연결
│    │         ├─── 4. MySQL: CONCAT()
│    │         ├─── 4. MSSQL: +
│    │         ├─── 4. Oracle: ||
│    │         └─── 4. PostgreSQL: ||
│    │
│    ├─── 2. 숫자 리터럴
│    │    ├─── 3. 정수
│    │    ├─── 3. 실수
│    │    ├─── 3. 과학적 표기법
│    │    └─── 3. 16진수 표기
│    │         ├─── 4. MySQL: 0x41424344
│    │         │    └─── 5. 문자열로 자동 변환
│    │         └─── 4. MSSQL: 0x41424344
│    │
│    └─── 2. NULL 리터럴
│         ├─── 3. NULL의 의미
│         ├─── 3. NULL 비교 (IS NULL)
│         └─── 3. UNION에서 NULL 활용
│
├─── 1. SQL 주석
│    ├─── 2. 한 줄 주석
│    │    ├─── 3. 대시 주석 (--)
│    │    │    ├─── 4. 공백 필요 여부
│    │    │    │    ├─── 5. MySQL: -- 뒤 공백 필수
│    │    │    │    ├─── 5. MSSQL: 공백 불필요
│    │    │    │    └─── 5. Oracle: 공백 불필요
│    │    │    └─── 4. 나머지 쿼리 무효화 용도
│    │    └─── 3. 해시 주석 (#)
│    │         ├─── 4. MySQL 전용
│    │         └─── 4. URL에서 프래그먼트 충돌
│    │              └─── 5. %23으로 인코딩 필요
│    │
│    └─── 2. 블록 주석 (/* */)
│         ├─── 3. 여러 줄 주석
│         ├─── 3. 인라인 주석
│         │    ├─── 4. 키워드 분리 (UN/**/ION)
│         │    └─── 4. 공백 대체 (SELECT/**/*)
│         ├─── 3. MySQL 버전 주석
│         │    ├─── 4. 문법: /*!버전번호 코드*/
│         │    ├─── 4. 예시: /*!50000 UNION*/
│         │    ├─── 4. 버전 번호 의미
│         │    │    ├─── 5. 5자리 형식 (50000 = 5.00.00)
│         │    │    └─── 5. 버전 이상이면 실행
│         │    └─── 4. WAF 우회 활용
│         │         ├─── 5. WAF는 주석으로 인식
│         │         └─── 5. MySQL은 코드로 실행
│         └─── 3. 중첩 주석
│              ├─── 4. PostgreSQL: 중첩 허용
│              └─── 4. MySQL: 중첩 불허
│
├─── 1. SQL 함수
│    ├─── 2. 문자열 함수
│    │    ├─── 3. SUBSTRING / SUBSTR
│    │    │    ├─── 4. 문법
│    │    │    │    ├─── 5. MySQL: SUBSTRING(str, pos, len)
│    │    │    │    ├─── 5. MSSQL: SUBSTRING(str, pos, len)
│    │    │    │    ├─── 5. Oracle: SUBSTR(str, pos, len)
│    │    │    │    └─── 5. PostgreSQL: SUBSTRING(str FROM pos FOR len)
│    │    │    ├─── 4. 인덱스 시작점
│    │    │    │    └─── 5. 모두 1부터 시작
│    │    │    └─── 4. Blind SQLi에서 활용
│    │    │         ├─── 5. 한 글자씩 추출
│    │    │         └─── 5. 이진 탐색과 조합
│    │    │
│    │    ├─── 3. CONCAT / 문자열 연결
│    │    │    ├─── 4. MySQL: CONCAT(a, b, c)
│    │    │    │    └─── 5. CONCAT_WS(구분자, a, b)
│    │    │    ├─── 4. MSSQL: a + b + c
│    │    │    ├─── 4. Oracle: a || b || c
│    │    │    └─── 4. PostgreSQL: a || b || c
│    │    │
│    │    ├─── 3. ASCII / ORD
│    │    │    ├─── 4. 문자 → 숫자 변환
│    │    │    ├─── 4. Blind SQLi에서 비교용
│    │    │    └─── 4. DBMS별 함수명
│    │    │         ├─── 5. MySQL: ASCII(), ORD()
│    │    │         ├─── 5. MSSQL: ASCII()
│    │    │         ├─── 5. Oracle: ASCII()
│    │    │         └─── 5. PostgreSQL: ASCII()
│    │    │
│    │    ├─── 3. CHAR / CHR
│    │    │    ├─── 4. 숫자 → 문자 변환
│    │    │    ├─── 4. 따옴표 우회 활용
│    │    │    │    └─── 5. CHAR(39) = '
│    │    │    └─── 4. DBMS별 함수명
│    │    │         ├─── 5. MySQL: CHAR()
│    │    │         ├─── 5. MSSQL: CHAR()
│    │    │         ├─── 5. Oracle: CHR()
│    │    │         └─── 5. PostgreSQL: CHR()
│    │    │
│    │    ├─── 3. LENGTH / LEN
│    │    │    ├─── 4. 문자열 길이
│    │    │    └─── 4. DBMS별 함수명
│    │    │         ├─── 5. MySQL: LENGTH(), CHAR_LENGTH()
│    │    │         ├─── 5. MSSQL: LEN()
│    │    │         ├─── 5. Oracle: LENGTH()
│    │    │         └─── 5. PostgreSQL: LENGTH()
│    │    │
│    │    ├─── 3. UPPER / LOWER
│    │    └─── 3. REPLACE
│    │
│    ├─── 2. 시간 지연 함수
│    │    ├─── 3. MySQL
│    │    │    ├─── 4. SLEEP(초)
│    │    │    │    ├─── 5. 문법: SLEEP(5)
│    │    │    │    ├─── 5. 반환값: 0
│    │    │    │    ├─── 5. 권한: 일반 사용자 가능
│    │    │    │    └─── 5. 차단 시 대안
│    │    │    │         └─── 6. BENCHMARK()
│    │    │    └─── 4. BENCHMARK(횟수, 표현식)
│    │    │         ├─── 5. 문법: BENCHMARK(10000000, SHA1('x'))
│    │    │         ├─── 5. CPU 부하 방식
│    │    │         ├─── 5. 시간 예측 어려움
│    │    │         └─── 5. 서버 부하 유발
│    │    │
│    │    ├─── 3. MSSQL
│    │    │    ├─── 4. WAITFOR DELAY
│    │    │    │    ├─── 5. 문법: WAITFOR DELAY '0:0:5'
│    │    │    │    ├─── 5. 시간 형식: 'hh:mm:ss'
│    │    │    │    └─── 5. Stacked Query 필요 여부
│    │    │    │         └─── 6. SELECT 내 사용 가능 여부
│    │    │    └─── 4. WAITFOR TIME
│    │    │         └─── 5. 특정 시각까지 대기
│    │    │
│    │    ├─── 3. PostgreSQL
│    │    │    └─── 4. pg_sleep(초)
│    │    │         ├─── 5. 문법: pg_sleep(5)
│    │    │         ├─── 5. SELECT pg_sleep(5)
│    │    │         └─── 5. 권한: 일반 사용자 가능
│    │    │
│    │    └─── 3. Oracle
│    │         ├─── 4. DBMS_LOCK.SLEEP
│    │         │    ├─── 5. 문법: DBMS_LOCK.SLEEP(5)
│    │         │    ├─── 5. 권한: EXECUTE 권한 필요
│    │         │    └─── 5. PL/SQL 블록 필요
│    │         └─── 4. Heavy Query 대안
│    │              ├─── 5. 큰 테이블 조인
│    │              └─── 5. 복잡한 연산 반복
│    │
│    ├─── 2. 조건 함수
│    │    ├─── 3. IF (MySQL)
│    │    │    ├─── 4. 문법: IF(조건, 참값, 거짓값)
│    │    │    └─── 4. Time-based에서 활용
│    │    │         └─── 5. IF(조건, SLEEP(5), 0)
│    │    │
│    │    ├─── 3. IIF (MSSQL)
│    │    │    └─── 4. 문법: IIF(조건, 참값, 거짓값)
│    │    │
│    │    ├─── 3. CASE WHEN
│    │    │    ├─── 4. 모든 DBMS 지원
│    │    │    ├─── 4. 단순 CASE
│    │    │    │    └─── 5. CASE 값 WHEN 비교 THEN 결과
│    │    │    └─── 4. 검색 CASE
│    │    │         └─── 5. CASE WHEN 조건 THEN 결과
│    │    │
│    │    ├─── 3. IFNULL / ISNULL / NVL / COALESCE
│    │    │    ├─── 4. MySQL: IFNULL()
│    │    │    ├─── 4. MSSQL: ISNULL()
│    │    │    ├─── 4. Oracle: NVL()
│    │    │    └─── 4. 표준: COALESCE()
│    │    │
│    │    └─── 3. NULLIF
│    │
│    ├─── 2. 시스템 정보 함수
│    │    ├─── 3. 버전 정보
│    │    │    ├─── 4. MySQL: VERSION(), @@version
│    │    │    ├─── 4. MSSQL: @@version
│    │    │    ├─── 4. PostgreSQL: version()
│    │    │    └─── 4. Oracle: v$version 테이블
│    │    │
│    │    ├─── 3. 현재 사용자
│    │    │    ├─── 4. MySQL: USER(), CURRENT_USER()
│    │    │    ├─── 4. MSSQL: SYSTEM_USER, SUSER_SNAME()
│    │    │    ├─── 4. PostgreSQL: current_user
│    │    │    └─── 4. Oracle: USER
│    │    │
│    │    ├─── 3. 현재 데이터베이스
│    │    │    ├─── 4. MySQL: DATABASE()
│    │    │    ├─── 4. MSSQL: DB_NAME()
│    │    │    ├─── 4. PostgreSQL: current_database()
│    │    │    └─── 4. Oracle: SYS_CONTEXT
│    │    │
│    │    └─── 3. 호스트 정보
│    │         ├─── 4. MySQL: @@hostname
│    │         └─── 4. MSSQL: HOST_NAME()
│    │
│    ├─── 2. 형변환 함수
│    │    ├─── 3. CAST
│    │    │    ├─── 4. 문법: CAST(값 AS 타입)
│    │    │    └─── 4. Error-based SQLi 활용
│    │    │         └─── 5. 타입 불일치 에러 유발
│    │    │
│    │    └─── 3. CONVERT
│    │         ├─── 4. MySQL: CONVERT(값, 타입)
│    │         └─── 4. MSSQL: CONVERT(타입, 값)
│    │
│    └─── 2. 에러 유발 함수 (Error-based)
│         ├─── 3. MySQL
│         │    ├─── 4. EXTRACTVALUE()
│         │    │    ├─── 5. 문법: EXTRACTVALUE(xml, xpath)
│         │    │    ├─── 5. XPath 에러에 데이터 포함
│         │    │    └─── 5. 예: EXTRACTVALUE(1, CONCAT(0x7e, (SELECT ...)))
│         │    ├─── 4. UPDATEXML()
│         │    │    ├─── 5. 문법: UPDATEXML(xml, xpath, 값)
│         │    │    └─── 5. 유사한 에러 유발
│         │    └─── 4. EXP()
│         │         ├─── 5. 오버플로우 에러 활용
│         │         └─── 5. MySQL 5.5+ 에서 동작
│         │
│         ├─── 3. MSSQL
│         │    ├─── 4. CONVERT 에러
│         │    │    └─── 5. 문자열 → 정수 변환 실패
│         │    └─── 4. 에러 메시지에 값 포함
│         │
│         └─── 3. Oracle
│              ├─── 4. CTXSYS.DRITHSX.SN()
│              └─── 4. UTL_INADDR.GET_HOST_ADDRESS()
│
└─── 1. SQL 연산자
     ├─── 2. 비교 연산자
     │    ├─── 3. 등호 (=)
     │    ├─── 3. 부등호 (<, >, <=, >=)
     │    ├─── 3. 불일치 (<>, !=)
     │    └─── 3. DBMS별 차이
     │
     ├─── 2. 논리 연산자
     │    ├─── 3. AND
     │    │    ├─── 4. 조건 추가 인젝션
     │    │    │    └─── 5. ' AND 1=1--
     │    │    └─── 4. 단락 평가
     │    ├─── 3. OR
     │    │    ├─── 4. 조건 우회 인젝션
     │    │    │    └─── 5. ' OR '1'='1
     │    │    └─── 4. 항상 참 만들기
     │    └─── 3. NOT
     │
     ├─── 2. 비트 연산자
     │    ├─── 3. AND (&)
     │    ├─── 3. OR (|)
     │    ├─── 3. XOR (^)
     │    └─── 3. Blind SQLi 비트 추출
     │         └─── 4. 한 비트씩 추출 기법
     │
     └─── 2. 문자열 연산자
          └─── 3. (위 문자열 연결 참조)
```

---

### Branch 2: DBMS 시스템 구조

```
DBMS 시스템
├─── 1. 메타데이터 저장소
│    ├─── 2. MySQL information_schema
│    │    ├─── 3. SCHEMATA 테이블
│    │    │    ├─── 4. SCHEMA_NAME 컬럼
│    │    │    └─── 4. 데이터베이스 목록 조회
│    │    ├─── 3. TABLES 테이블
│    │    │    ├─── 4. TABLE_SCHEMA 컬럼
│    │    │    ├─── 4. TABLE_NAME 컬럼
│    │    │    └─── 4. 테이블 목록 조회 쿼리
│    │    │         └─── 5. SELECT table_name FROM information_schema.tables WHERE table_schema=database()
│    │    ├─── 3. COLUMNS 테이블
│    │    │    ├─── 4. TABLE_NAME 컬럼
│    │    │    ├─── 4. COLUMN_NAME 컬럼
│    │    │    ├─── 4. DATA_TYPE 컬럼
│    │    │    └─── 4. 컬럼 목록 조회 쿼리
│    │    └─── 3. USER_PRIVILEGES 테이블
│    │         └─── 4. 권한 확인
│    │
│    ├─── 2. MSSQL 시스템 카탈로그
│    │    ├─── 3. master.sys.databases
│    │    │    └─── 4. 데이터베이스 목록
│    │    ├─── 3. sys.tables
│    │    │    └─── 4. 테이블 목록
│    │    ├─── 3. sys.columns
│    │    │    └─── 4. 컬럼 목록
│    │    ├─── 3. sysobjects (구버전)
│    │    │    └─── 4. xtype='U' 필터
│    │    └─── 3. INFORMATION_SCHEMA (표준)
│    │
│    ├─── 2. PostgreSQL 시스템 카탈로그
│    │    ├─── 3. pg_database
│    │    ├─── 3. pg_tables
│    │    ├─── 3. pg_columns
│    │    ├─── 3. pg_user
│    │    └─── 3. information_schema (표준)
│    │
│    └─── 2. Oracle 데이터 딕셔너리
│         ├─── 3. ALL_TABLES
│         ├─── 3. ALL_TAB_COLUMNS
│         ├─── 3. ALL_USERS
│         ├─── 3. DBA_* 뷰 (DBA 권한 필요)
│         └─── 3. USER_* 뷰 (현재 사용자)
│
├─── 1. 권한 시스템
│    ├─── 2. MySQL 권한
│    │    ├─── 3. 글로벌 권한
│    │    ├─── 3. 데이터베이스 권한
│    │    ├─── 3. 테이블 권한
│    │    ├─── 3. 컬럼 권한
│    │    └─── 3. FILE 권한
│    │         ├─── 4. LOAD_FILE() 사용 조건
│    │         └─── 4. INTO OUTFILE 사용 조건
│    │
│    ├─── 2. MSSQL 권한
│    │    ├─── 3. 서버 역할
│    │    │    ├─── 4. sysadmin
│    │    │    └─── 4. public
│    │    ├─── 3. 데이터베이스 역할
│    │    └─── 3. xp_cmdshell 실행 권한
│    │         ├─── 4. sysadmin 필요
│    │         ├─── 4. 활성화 필요
│    │         │    └─── 5. sp_configure 'xp_cmdshell', 1
│    │         └─── 4. 프록시 계정 설정
│    │
│    └─── 2. Oracle 권한
│         ├─── 3. 시스템 권한
│         ├─── 3. 객체 권한
│         └─── 3. 역할
│
├─── 1. 파일 시스템 접근
│    ├─── 2. MySQL 파일 접근
│    │    ├─── 3. LOAD_FILE()
│    │    │    ├─── 4. 문법: LOAD_FILE('/etc/passwd')
│    │    │    ├─── 4. 필요 권한: FILE
│    │    │    ├─── 4. secure_file_priv 제한
│    │    │    │    └─── 5. 허용 디렉토리 확인
│    │    │    └─── 4. OOB 데이터 추출 활용
│    │    │         └─── 5. Windows UNC 경로
│    │    └─── 3. INTO OUTFILE / DUMPFILE
│    │         ├─── 4. 웹쉘 작성
│    │         └─── 4. 제한 사항
│    │
│    ├─── 2. MSSQL 파일 접근
│    │    ├─── 3. xp_cmdshell
│    │    │    ├─── 4. OS 명령 실행
│    │    │    │    └─── 5. EXEC xp_cmdshell 'whoami'
│    │    │    └─── 4. 결과 반환
│    │    ├─── 3. OPENROWSET
│    │    │    ├─── 4. 파일 읽기
│    │    │    └─── 4. 원격 서버 접근
│    │    ├─── 3. BULK INSERT
│    │    └─── 3. xp_dirtree
│    │         ├─── 4. 디렉토리 목록
│    │         └─── 4. OOB 활용 (UNC)
│    │
│    ├─── 2. PostgreSQL 파일 접근
│    │    ├─── 3. COPY 명령
│    │    │    ├─── 4. COPY TO: 파일 쓰기
│    │    │    └─── 4. COPY FROM: 파일 읽기
│    │    ├─── 3. pg_read_file()
│    │    │    └─── 4. 슈퍼유저 필요
│    │    └─── 3. Large Objects
│    │         ├─── 4. lo_import()
│    │         └─── 4. lo_export()
│    │
│    └─── 2. Oracle 파일 접근
│         ├─── 3. UTL_FILE
│         └─── 3. DIRECTORY 객체
│
└─── 1. 네트워크 기능 (OOB용)
     ├─── 2. MySQL 네트워크
     │    └─── 3. LOAD_FILE() + UNC
     │         ├─── 4. Windows 전용
     │         └─── 4. DNS 요청 유발
     │
     ├─── 2. MSSQL 네트워크
     │    ├─── 3. xp_dirtree + UNC
     │    ├─── 3. xp_fileexist + UNC
     │    └─── 3. OPENROWSET
     │
     ├─── 2. PostgreSQL 네트워크
     │    ├─── 3. dblink
     │    │    ├─── 4. dblink_connect()
     │    │    └─── 4. 원격 DB 연결
     │    └─── 3. COPY ... TO PROGRAM
     │
     └─── 2. Oracle 네트워크
          ├─── 3. UTL_HTTP
          │    └─── 4. HTTP 요청 생성
          ├─── 3. UTL_INADDR
          │    └─── 4. DNS 조회
          ├─── 3. UTL_TCP
          └─── 3. HTTPURITYPE
```

---

### Branch 3: HTTP 프로토콜

```
HTTP 프로토콜
├─── 1. HTTP 요청 구조
│    ├─── 2. 요청 라인
│    │    ├─── 3. HTTP 메서드
│    │    │    ├─── 4. GET
│    │    │    │    ├─── 5. 쿼리 스트링 파라미터
│    │    │    │    │    ├─── 6. ?key=value 형식
│    │    │    │    │    ├─── 6. & 구분자
│    │    │    │    │    └─── 6. URL 인코딩 필요성
│    │    │    │    ├─── 5. 캐싱 가능
│    │    │    │    └─── 5. 길이 제한 (브라우저/서버별)
│    │    │    │         └─── 6. 일반적으로 2KB-8KB
│    │    │    ├─── 4. POST
│    │    │    │    ├─── 5. 요청 바디에 데이터
│    │    │    │    ├─── 5. Content-Type 필요
│    │    │    │    └─── 5. 길이 제한 없음 (서버 설정)
│    │    │    ├─── 4. PUT
│    │    │    ├─── 4. DELETE
│    │    │    ├─── 4. HEAD
│    │    │    ├─── 4. OPTIONS
│    │    │    └─── 4. PATCH
│    │    │
│    │    ├─── 3. 요청 URI
│    │    │    ├─── 4. 경로 (Path)
│    │    │    │    └─── 5. 경로 파라미터
│    │    │    │         └─── 6. /user/{id} 형식
│    │    │    ├─── 4. 쿼리 스트링
│    │    │    └─── 4. 프래그먼트 (#)
│    │    │         └─── 5. 서버로 전송 안됨
│    │    │
│    │    └─── 3. HTTP 버전
│    │         ├─── 4. HTTP/1.0
│    │         ├─── 4. HTTP/1.1
│    │         └─── 4. HTTP/2
│    │
│    ├─── 2. 요청 헤더
│    │    ├─── 3. Host 헤더
│    │    │    └─── 4. 필수 (HTTP/1.1)
│    │    ├─── 3. Content-Type 헤더
│    │    │    ├─── 4. application/x-www-form-urlencoded
│    │    │    │    ├─── 5. key=value&key2=value2 형식
│    │    │    │    └─── 5. URL 인코딩 적용
│    │    │    ├─── 4. multipart/form-data
│    │    │    │    ├─── 5. 파일 업로드용
│    │    │    │    ├─── 5. boundary 구분
│    │    │    │    └─── 5. 각 파트별 Content-Disposition
│    │    │    ├─── 4. application/json
│    │    │    │    ├─── 5. JSON 형식 바디
│    │    │    │    └─── 5. SQLi 위치: 값 내부
│    │    │    └─── 4. text/xml
│    │    │         └─── 5. XML 형식 바디
│    │    │
│    │    ├─── 3. Content-Length 헤더
│    │    ├─── 3. Cookie 헤더
│    │    │    ├─── 4. 쿠키 형식
│    │    │    │    └─── 5. name=value; name2=value2
│    │    │    ├─── 4. SQLi 인젝션 포인트
│    │    │    └─── 4. 세션 관리 연계
│    │    │
│    │    ├─── 3. User-Agent 헤더
│    │    │    ├─── 4. 브라우저/클라이언트 식별
│    │    │    └─── 4. SQLi 인젝션 포인트
│    │    │         └─── 5. 로깅에 저장되는 경우
│    │    │
│    │    ├─── 3. Referer 헤더
│    │    │    └─── 4. SQLi 인젝션 포인트
│    │    │
│    │    ├─── 3. X-Forwarded-For 헤더
│    │    │    └─── 4. SQLi 인젝션 포인트
│    │    │         └─── 5. IP 로깅에 저장되는 경우
│    │    │
│    │    ├─── 3. Authorization 헤더
│    │    │    ├─── 4. Basic 인증
│    │    │    │    └─── 5. Base64(user:pass)
│    │    │    └─── 4. Bearer 토큰
│    │    │
│    │    └─── 3. Accept 헤더
│    │
│    └─── 2. 요청 바디
│         ├─── 3. Form 데이터
│         │    ├─── 4. URL 인코딩된 폼
│         │    └─── 4. Multipart 폼
│         ├─── 3. JSON 데이터
│         │    ├─── 4. 키-값 구조
│         │    │    └─── 5. SQLi 위치: 값 내부
│         │    ├─── 4. 중첩 객체
│         │    └─── 4. 배열
│         └─── 3. XML 데이터
│              └─── 4. 태그 내용에 SQLi
│
├─── 1. HTTP 응답 구조
│    ├─── 2. 상태 라인
│    │    └─── 3. 상태 코드
│    │         ├─── 4. 2xx 성공
│    │         │    └─── 5. 200 OK
│    │         ├─── 4. 3xx 리다이렉션
│    │         │    ├─── 5. 301 Moved Permanently
│    │         │    └─── 5. 302 Found
│    │         ├─── 4. 4xx 클라이언트 오류
│    │         │    ├─── 5. 400 Bad Request
│    │         │    ├─── 5. 403 Forbidden
│    │         │    │    └─── 6. WAF 차단 가능성
│    │         │    └─── 5. 404 Not Found
│    │         └─── 4. 5xx 서버 오류
│    │              ├─── 5. 500 Internal Server Error
│    │              │    └─── 6. SQL 에러 가능성
│    │              └─── 5. 503 Service Unavailable
│    │
│    ├─── 2. 응답 헤더
│    │    ├─── 3. Content-Type
│    │    ├─── 3. Content-Length
│    │    │    └─── 4. 응답 크기 비교 (Boolean 탐지)
│    │    ├─── 3. Set-Cookie
│    │    └─── 3. X-* 커스텀 헤더
│    │
│    └─── 2. 응답 바디
│         ├─── 3. HTML 콘텐츠
│         │    └─── 4. 에러 메시지 노출 여부
│         ├─── 3. JSON 응답
│         └─── 3. 바이너리 데이터
│
└─── 1. 응답 시간 측정
     ├─── 2. 라운드트립 시간
     ├─── 2. 베이스라인 측정
     │    ├─── 3. 정상 요청 시간 기록
     │    ├─── 3. 다중 샘플 평균
     │    └─── 3. 표준 편차 계산
     ├─── 2. 지연 감지 임계값
     │    ├─── 3. 절대값 기준
     │    └─── 3. 베이스라인 대비 비율
     └─── 2. 네트워크 지연 고려
          ├─── 3. 인터넷 지연
          ├─── 3. 프록시 지연
          └─── 3. 서버 부하
```

---

### Branch 4: 인코딩 체계

```
인코딩 체계
├─── 1. URL 인코딩
│    ├─── 2. 퍼센트 인코딩 기초
│    │    ├─── 3. 인코딩 규칙
│    │    │    ├─── 4. %XX 형식 (16진수)
│    │    │    ├─── 4. 예약 문자 인코딩
│    │    │    │    ├─── 5. 공백: %20 또는 +
│    │    │    │    ├─── 5. 작은따옴표: %27
│    │    │    │    ├─── 5. 큰따옴표: %22
│    │    │    │    ├─── 5. 샵: %23
│    │    │    │    ├─── 5. 앰퍼샌드: %26
│    │    │    │    ├─── 5. 등호: %3D
│    │    │    │    ├─── 5. 슬래시: %2F
│    │    │    │    └─── 5. 세미콜론: %3B
│    │    │    └─── 4. 안전 문자 (인코딩 불필요)
│    │    │         └─── 5. 알파벳, 숫자, -_.~
│    │    │
│    │    └─── 3. 디코딩 규칙
│    │         └─── 4. %XX → 바이트
│    │
│    ├─── 2. 이중 URL 인코딩
│    │    ├─── 3. 개념
│    │    │    └─── 4. % 자체를 인코딩: %25
│    │    ├─── 3. 예시
│    │    │    ├─── 4. ' → %27 → %2527
│    │    │    └─── 4. < → %3C → %253C
│    │    ├─── 3. WAF 우회 원리
│    │    │    ├─── 4. WAF: 1회 디코딩
│    │    │    └─── 4. 백엔드: 2회 디코딩
│    │    └─── 3. 삼중 인코딩
│    │         └─── 4. %252527 등
│    │
│    └─── 2. 혼합 인코딩
│         ├─── 3. 부분 인코딩
│         │    └─── 4. UN%49ON (I만 인코딩)
│         └─── 3. 대소문자 혼합
│              └─── 4. %2f vs %2F
│
├─── 1. 유니코드 인코딩
│    ├─── 2. UTF-8 인코딩
│    │    ├─── 3. 멀티바이트 표현
│    │    │    ├─── 4. 1바이트: 0xxxxxxx
│    │    │    ├─── 4. 2바이트: 110xxxxx 10xxxxxx
│    │    │    ├─── 4. 3바이트: 1110xxxx 10xxxxxx 10xxxxxx
│    │    │    └─── 4. 4바이트: 11110xxx ...
│    │    ├─── 3. 오버롱 인코딩
│    │    │    ├─── 4. 개념: 불필요하게 긴 바이트 사용
│    │    │    ├─── 4. 예: '/' = 0x2F
│    │    │    │    ├─── 5. 정상: %2F
│    │    │    │    ├─── 5. 오버롱 2바이트: %C0%AF
│    │    │    │    └─── 5. 오버롱 3바이트: %E0%80%AF
│    │    │    └─── 4. 보안 우회 활용
│    │    └─── 3. 잘못된 UTF-8
│    │         └─── 4. 잘림 시퀀스 활용
│    │
│    ├─── 2. %u 인코딩 (IIS 전용)
│    │    ├─── 3. 형식: %uXXXX
│    │    ├─── 3. 예: %u0027 = '
│    │    └─── 3. IIS에서만 디코딩
│    │
│    └─── 2. 유니코드 정규화
│         ├─── 3. NFC / NFD / NFKC / NFKD
│         ├─── 3. 동형 문자 (Homoglyph)
│         │    └─── 4. 다른 코드포인트, 같은 모양
│         └─── 3. 정규화 우회
│
├─── 1. HTML 엔티티
│    ├─── 2. 숫자 엔티티
│    │    ├─── 3. 10진수: &#39; = '
│    │    └─── 3. 16진수: &#x27; = '
│    ├─── 2. 명명 엔티티
│    │    ├─── 3. &apos; = '
│    │    ├─── 3. &quot; = "
│    │    └─── 3. &amp; = &
│    └─── 2. HTML 컨텍스트에서만 디코딩
│
├─── 1. 16진수 인코딩
│    ├─── 2. SQL 16진수 리터럴
│    │    ├─── 3. MySQL: 0x41424344
│    │    │    └─── 4. 따옴표 없이 문자열 표현
│    │    └─── 3. MSSQL: 0x41424344
│    └─── 2. 따옴표 우회 활용
│         └─── 3. SELECT 0x61646D696E → 'admin'
│
└─── 1. Base64 인코딩
     ├─── 2. 인코딩 규칙
     │    ├─── 3. 64개 문자 사용
     │    └─── 3. 패딩 (=)
     ├─── 2. 애플리케이션 사용 사례
     │    ├─── 3. Basic 인증
     │    └─── 3. JSON 내 바이너리
     └─── 2. SQLi에서 활용
          └─── 3. 일부 애플리케이션이 Base64 디코딩 후 쿼리 사용
```

---

### Branch 5: 입력 처리 및 검증

```
입력 처리
├─── 1. 입력 소스
│    ├─── 2. URL 파라미터
│    │    ├─── 3. 쿼리 스트링 (?key=value)
│    │    │    ├─── 4. 단일 값
│    │    │    ├─── 4. 배열 값 (?id[]=1&id[]=2)
│    │    │    └─── 4. 중복 키 처리
│    │    │         ├─── 5. 첫 번째 값 사용
│    │    │         ├─── 5. 마지막 값 사용
│    │    │         └─── 5. 모두 사용 (HPP 가능)
│    │    └─── 3. 경로 파라미터 (/user/123)
│    │         └─── 4. RESTful API
│    │
│    ├─── 2. 요청 바디
│    │    ├─── 3. Form 데이터
│    │    ├─── 3. JSON 데이터
│    │    │    ├─── 4. 문자열 값
│    │    │    ├─── 4. 숫자 값
│    │    │    └─── 4. 중첩 객체
│    │    └─── 3. XML 데이터
│    │
│    ├─── 2. HTTP 헤더
│    │    ├─── 3. Cookie
│    │    │    └─── 4. 세션 ID, 사용자 설정 등
│    │    ├─── 3. User-Agent
│    │    ├─── 3. Referer
│    │    ├─── 3. X-Forwarded-For
│    │    └─── 3. 커스텀 헤더
│    │
│    └─── 2. 간접 입력
│         ├─── 3. 데이터베이스 저장 값
│         │    └─── 4. Second-Order SQLi
│         ├─── 3. 파일 내용
│         └─── 3. 외부 API 응답
│
├─── 1. 입력 검증 방식
│    ├─── 2. 화이트리스트 검증
│    │    ├─── 3. 허용 문자만 통과
│    │    ├─── 3. 정규표현식 패턴
│    │    │    └─── 4. ^[a-zA-Z0-9]+$
│    │    └─── 3. 강력하지만 제한적
│    │
│    ├─── 2. 블랙리스트 검증
│    │    ├─── 3. 금지 문자/패턴 차단
│    │    ├─── 3. 우회 가능성 높음
│    │    │    ├─── 4. 인코딩 우회
│    │    │    ├─── 4. 대소문자 우회
│    │    │    └─── 4. 동의어 우회
│    │    └─── 3. 예: ', --, UNION 차단
│    │
│    ├─── 2. 타입 검증
│    │    ├─── 3. 숫자 검증
│    │    │    ├─── 4. is_numeric()
│    │    │    ├─── 4. intval()
│    │    │    └─── 4. 정규표현식
│    │    ├─── 3. 이메일 검증
│    │    └─── 3. 날짜 검증
│    │
│    └─── 2. 길이 검증
│         └─── 3. 최대 길이 제한
│
├─── 1. 이스케이프 처리
│    ├─── 2. SQL 이스케이프
│    │    ├─── 3. mysqli_real_escape_string
│    │    │    ├─── 4. 처리하는 문자
│    │    │    │    ├─── 5. ' → \'
│    │    │    │    ├─── 5. " → \"
│    │    │    │    ├─── 5. \ → \\
│    │    │    │    └─── 5. NULL → \0
│    │    │    └─── 4. 문자셋 문제
│    │    │         └─── 5. GBK 멀티바이트 우회
│    │    ├─── 3. addslashes
│    │    │    └─── 4. 불완전한 이스케이프
│    │    └─── 3. PDO::quote
│    │
│    ├─── 2. 이스케이프 우회
│    │    ├─── 3. 멀티바이트 문자 우회
│    │    │    ├─── 4. GBK: %bf%27 → 유효한 문자 + '
│    │    │    └─── 4. 문자셋 일치 중요
│    │    ├─── 3. 숫자 컨텍스트
│    │    │    └─── 4. WHERE id=1 (따옴표 없음)
│    │    └─── 3. 식별자 컨텍스트
│    │         └─── 4. ORDER BY 컬럼명
│    │
│    └─── 2. 컨텍스트별 이스케이프
│         ├─── 3. 문자열 컨텍스트
│         ├─── 3. 숫자 컨텍스트
│         ├─── 3. 식별자 컨텍스트
│         └─── 3. LIKE 컨텍스트
│              └─── 4. % 와 _ 처리
│
└─── 1. 파라미터화 쿼리
     ├─── 2. Prepared Statement
     │    ├─── 3. 동작 원리
     │    │    ├─── 4. 쿼리 구조 먼저 컴파일
     │    │    ├─── 4. 파라미터 나중에 바인딩
     │    │    └─── 4. 데이터는 항상 데이터로 처리
     │    ├─── 3. PHP PDO
     │    │    ├─── 4. prepare() + execute()
     │    │    └─── 4. 에뮬레이션 모드 주의
     │    │         └─── 5. PDO::ATTR_EMULATE_PREPARES
     │    ├─── 3. Java PreparedStatement
     │    ├─── 3. Python DB-API
     │    └─── 3. 한계
     │         ├─── 4. 동적 테이블/컬럼명
     │         │    └─── 5. 화이트리스트로 검증 필요
     │         ├─── 4. ORDER BY 방향
     │         └─── 4. IN 절 다중 값
     │
     ├─── 2. 저장 프로시저
     │    ├─── 3. 장점: 쿼리 캡슐화
     │    └─── 3. 주의: 내부에서 동적 SQL 사용 시 취약
     │
     └─── 2. ORM
          ├─── 3. 객체-관계 매핑
          ├─── 3. 자동 파라미터화
          └─── 3. Raw Query 사용 시 주의
```

---

### Branch 6: WAF 및 보안 메커니즘

```
WAF 및 보안
├─── 1. WAF 아키텍처
│    ├─── 2. 배치 위치
│    │    ├─── 3. 네트워크 기반 WAF
│    │    ├─── 3. 호스트 기반 WAF
│    │    └─── 3. 클라우드 WAF
│    │         ├─── 4. Cloudflare
│    │         ├─── 4. AWS WAF
│    │         └─── 4. Akamai
│    │
│    ├─── 2. 처리 파이프라인
│    │    ├─── 3. 요청 파싱
│    │    │    ├─── 4. URL 디코딩
│    │    │    ├─── 4. 파라미터 추출
│    │    │    └─── 4. 바디 파싱
│    │    ├─── 3. 정규화
│    │    │    ├─── 4. 대소문자 통일
│    │    │    ├─── 4. 공백 정규화
│    │    │    ├─── 4. 인코딩 디코딩
│    │    │    │    ├─── 5. 반복 디코딩 여부
│    │    │    │    └─── 5. 디코딩 깊이
│    │    │    └─── 4. 주석 제거
│    │    ├─── 3. 규칙 매칭
│    │    └─── 3. 액션 수행
│    │         ├─── 4. 허용
│    │         ├─── 4. 차단
│    │         ├─── 4. 로깅
│    │         └─── 4. 챌린지 (CAPTCHA)
│    │
│    └─── 2. 탐지 방식
│         ├─── 3. 시그니처 기반
│         │    ├─── 4. 정규표현식 규칙
│         │    │    ├─── 5. UNION.*SELECT 패턴
│         │    │    ├─── 5. OR.*=.* 패턴
│         │    │    └─── 5. 키워드 목록
│         │    ├─── 4. 우회 가능성
│         │    │    └─── 5. 패턴과 다르게 표현
│         │    └─── 4. 오탐 (False Positive)
│         │
│         ├─── 3. 이상 탐지
│         │    ├─── 4. 통계적 분석
│         │    ├─── 4. 머신러닝
│         │    └─── 4. 행동 분석
│         │
│         └─── 3. 점수 기반
│              ├─── 4. 각 규칙에 점수 부여
│              └─── 4. 임계값 초과 시 차단
│
├─── 1. WAF 우회 기법
│    ├─── 2. 인코딩 우회
│    │    ├─── 3. URL 인코딩
│    │    ├─── 3. 이중 인코딩
│    │    ├─── 3. 유니코드 우회
│    │    └─── 3. 16진수 우회
│    │
│    ├─── 2. 대소문자 조작
│    │    ├─── 3. 혼합: uNiOn SeLeCt
│    │    └─── 3. WAF 정규화 여부에 따라
│    │
│    ├─── 2. 공백 우회
│    │    ├─── 3. 탭: %09
│    │    ├─── 3. 개행: %0a, %0d
│    │    ├─── 3. 주석: /**/
│    │    ├─── 3. 괄호: (( ))
│    │    └─── 3. 백틱: ` (MySQL)
│    │
│    ├─── 2. 주석 우회
│    │    ├─── 3. 인라인 주석
│    │    │    └─── 4. UN/**/ION
│    │    ├─── 3. MySQL 버전 주석
│    │    │    └─── 4. /*!50000UNION*/
│    │    └─── 3. 주석 내 쓰레기 데이터
│    │         └─── 4. /*! foo bar */
│    │
│    ├─── 2. 키워드 대체
│    │    ├─── 3. 동의어 사용
│    │    │    ├─── 4. OR → ||
│    │    │    ├─── 4. AND → &&
│    │    │    └─── 4. = → LIKE
│    │    ├─── 3. 함수 대체
│    │    │    ├─── 4. SUBSTRING → MID, SUBSTR
│    │    │    └─── 4. CONCAT → CONCAT_WS
│    │    └─── 3. 연산자 대체
│    │         └─── 4. BETWEEN, IN, LIKE
│    │
│    ├─── 2. HTTP Parameter Pollution
│    │    ├─── 3. 동일 파라미터 중복
│    │    │    └─── 4. ?id=1&id=2
│    │    ├─── 3. WAF와 백엔드 처리 차이
│    │    │    ├─── 4. WAF: 첫 번째 값 검사
│    │    │    └─── 4. 백엔드: 마지막 값 사용
│    │    └─── 3. 서버별 동작 차이
│    │         ├─── 4. ASP.NET: 쉼표로 결합
│    │         ├─── 4. PHP: 마지막 값
│    │         └─── 4. JSP: 첫 번째 값
│    │
│    ├─── 2. 청크 전송 인코딩
│    │    ├─── 3. Transfer-Encoding: chunked
│    │    └─── 3. 페이로드 분할
│    │
│    └─── 2. 버퍼 오버플로우
│         ├─── 3. 긴 페이로드로 WAF 우회
│         └─── 3. WAF 처리 한계 초과
│
├─── 1. 에러 처리
│    ├─── 2. 에러 메시지 노출
│    │    ├─── 3. 상세 에러 (개발 모드)
│    │    │    ├─── 4. SQL 쿼리 노출
│    │    │    ├─── 4. 파일 경로 노출
│    │    │    └─── 4. 스택 트레이스
│    │    └─── 3. 일반 에러 (프로덕션)
│    │         └─── 4. 정보 없음
│    │
│    ├─── 2. 에러 기반 정보 수집
│    │    ├─── 3. DBMS 식별
│    │    │    └─── 4. 에러 메시지 패턴
│    │    └─── 3. 쿼리 구조 파악
│    │
│    └─── 2. 커스텀 에러 페이지
│         └─── 3. 동일한 응답으로 에러 숨김
│
└─── 1. 기타 보안 메커니즘
     ├─── 2. Rate Limiting
     │    ├─── 3. 요청 빈도 제한
     │    └─── 3. 자동화 공격 방해
     │
     ├─── 2. CAPTCHA
     │    └─── 3. 봇 탐지
     │
     └─── 2. 로깅/모니터링
          ├─── 3. 공격 시도 기록
          └─── 3. 알림 시스템
```

---

### Branch 7: 공격 방법론

```
공격 방법론
├─── 1. 인젝션 포인트 발견
│    ├─── 2. 파라미터 식별
│    │    ├─── 3. GET 파라미터
│    │    ├─── 3. POST 파라미터
│    │    ├─── 3. 쿠키
│    │    ├─── 3. HTTP 헤더
│    │    └─── 3. 숨겨진 파라미터
│    │         ├─── 4. JavaScript 분석
│    │         └─── 4. 파라미터 추측
│    │
│    ├─── 2. 취약점 탐지
│    │    ├─── 3. 에러 유발 테스트
│    │    │    ├─── 4. 작은따옴표 (')
│    │    │    ├─── 4. 큰따옴표 (")
│    │    │    ├─── 4. 백슬래시 (\)
│    │    │    └─── 4. 주석 (--, #)
│    │    │
│    │    ├─── 3. Boolean 차이 테스트
│    │    │    ├─── 4. AND 1=1 vs AND 1=2
│    │    │    ├─── 4. OR 1=1 vs OR 1=2
│    │    │    └─── 4. 응답 비교
│    │    │         ├─── 5. 상태 코드
│    │    │         ├─── 5. 응답 길이
│    │    │         └─── 5. 응답 내용
│    │    │
│    │    └─── 3. 시간 지연 테스트
│    │         ├─── 4. SLEEP(5) 삽입
│    │         └─── 4. 응답 시간 측정
│    │
│    └─── 2. 컨텍스트 파악
│         ├─── 3. 문자열 컨텍스트
│         │    ├─── 4. 작은따옴표 내부
│         │    └─── 4. 큰따옴표 내부
│         ├─── 3. 숫자 컨텍스트
│         │    └─── 4. 따옴표 없음
│         ├─── 3. 식별자 컨텍스트
│         │    └─── 4. 컬럼명, 테이블명
│         └─── 3. 복합 쿼리 컨텍스트
│              └─── 4. 서브쿼리 내부
│
├─── 1. DBMS 핑거프린팅
│    ├─── 2. 에러 메시지 분석
│    │
│    ├─── 2. 문법 차이 테스트
│    │    ├─── 3. 주석 문법
│    │    │    └─── 4. # 지원: MySQL
│    │    ├─── 3. 문자열 연결
│    │    │    ├─── 4. || : Oracle, PostgreSQL
│    │    │    └─── 4. + : MSSQL
│    │    └─── 3. 조건문 문법
│    │
│    ├─── 2. 함수 존재 테스트
│    │    ├─── 3. SLEEP(): MySQL
│    │    ├─── 3. WAITFOR: MSSQL
│    │    ├─── 3. pg_sleep(): PostgreSQL
│    │    └─── 3. DBMS_LOCK.SLEEP: Oracle
│    │
│    └─── 2. 시스템 변수/테이블
│         ├─── 3. @@version: MySQL, MSSQL
│         ├─── 3. version(): PostgreSQL
│         └─── 3. v$version: Oracle
│
├─── 1. 데이터 추출 전략
│    ├─── 2. UNION 기반 추출
│    │    ├─── 3. 컬럼 수 파악
│    │    ├─── 3. 출력 컬럼 확인
│    │    ├─── 3. 메타데이터 추출
│    │    │    ├─── 4. 데이터베이스 목록
│    │    │    ├─── 4. 테이블 목록
│    │    │    └─── 4. 컬럼 목록
│    │    └─── 3. 실제 데이터 추출
│    │
│    ├─── 2. Blind 추출
│    │    ├─── 3. Boolean 기반
│    │    │    ├─── 4. 참/거짓 조건 구성
│    │    │    ├─── 4. 한 글자씩 추출
│    │    │    │    ├─── 5. SUBSTRING(data, pos, 1)
│    │    │    │    └─── 5. 위치 증가
│    │    │    ├─── 4. ASCII 값 비교
│    │    │    │    ├─── 5. ASCII(SUBSTRING(...)) > 64
│    │    │    │    └─── 5. 이진 탐색
│    │    │    └─── 4. 최적화
│    │    │         ├─── 5. 이진 탐색 (7회로 1글자)
│    │    │         └─── 5. 비트 연산 (8회로 1글자)
│    │    │
│    │    └─── 3. Time 기반
│    │         ├─── 4. 조건부 지연
│    │         │    └─── 5. IF(조건, SLEEP(5), 0)
│    │         ├─── 4. 응답 시간 측정
│    │         │    ├─── 5. 베이스라인 대비
│    │         │    └─── 5. 임계값 설정
│    │         └─── 4. 한 글자씩 추출
│    │
│    └─── 2. Out-of-Band 추출
│         ├─── 3. DNS 기반
│         │    ├─── 4. 데이터를 서브도메인으로
│         │    │    └─── 5. data.attacker.com
│         │    ├─── 4. DNS 로깅 서버
│         │    └─── 4. 길이 제한 (63자/레이블)
│         │
│         └─── 3. HTTP 기반
│              ├─── 4. 데이터를 URL 파라미터로
│              └─── 4. HTTP 로깅 서버
│
└─── 1. 후속 공격
     ├─── 2. 권한 상승
     │    ├─── 3. DB 관리자 계정 탈취
     │    └─── 3. OS 명령 실행
     │
     ├─── 2. 파일 시스템 접근
     │    ├─── 3. 파일 읽기
     │    └─── 3. 파일 쓰기 (웹쉘)
     │
     └─── 2. 피벗팅
          ├─── 3. 내부 네트워크 접근
          └─── 3. 다른 시스템 공격
```

---

### Branch 8: DAST 구현

```
DAST 구현
├─── 1. 크롤링
│    ├─── 2. 링크 추출
│    │    ├─── 3. HTML 파싱
│    │    │    ├─── 4. <a href=""> 태그
│    │    │    ├─── 4. <form action=""> 태그
│    │    │    └─── 4. <script src=""> 태그
│    │    ├─── 3. JavaScript 분석
│    │    │    ├─── 4. 동적 URL 생성
│    │    │    └─── 4. AJAX 요청
│    │    └─── 3. 범위 제한
│    │         ├─── 4. 도메인 제한
│    │         └─── 4. 깊이 제한
│    │
│    ├─── 2. 폼 발견
│    │    ├─── 3. 입력 필드 추출
│    │    │    ├─── 4. <input> 태그
│    │    │    ├─── 4. <textarea> 태그
│    │    │    └─── 4. <select> 태그
│    │    ├─── 3. 필드 타입 분석
│    │    │    ├─── 4. text, hidden, password
│    │    │    └─── 4. 필수/선택 필드
│    │    └─── 3. 제출 방법
│    │         ├─── 4. method (GET/POST)
│    │         └─── 4. enctype
│    │
│    └─── 2. 인증 처리
│         ├─── 3. 로그인 폼 인식
│         ├─── 3. 세션 관리
│         └─── 3. 인증 상태 유지
│
├─── 1. 페이로드 주입
│    ├─── 2. 파라미터별 테스트
│    │    ├─── 3. 하나씩 테스트
│    │    └─── 3. 정상 값 유지
│    │
│    ├─── 2. 페이로드 선택
│    │    ├─── 3. 탐지 페이로드
│    │    │    ├─── 4. 에러 유발
│    │    │    ├─── 4. Boolean 테스트
│    │    │    └─── 4. 시간 테스트
│    │    ├─── 3. DBMS별 페이로드
│    │    └─── 3. 우회 페이로드
│    │
│    ├─── 2. 인코딩 적용
│    │    ├─── 3. URL 인코딩
│    │    └─── 3. 컨텍스트별 인코딩
│    │
│    └─── 2. 요청 생성/전송
│         ├─── 3. HTTP 클라이언트
│         ├─── 3. 헤더 설정
│         └─── 3. 타임아웃 설정
│
├─── 1. 응답 분석
│    ├─── 2. 에러 패턴 매칭
│    │    ├─── 3. DBMS별 에러 메시지
│    │    └─── 3. 정규표현식 매칭
│    │
│    ├─── 2. Boolean 응답 비교
│    │    ├─── 3. 상태 코드 비교
│    │    ├─── 3. 응답 길이 비교
│    │    │    ├─── 4. 절대 차이
│    │    │    └─── 4. 비율 차이
│    │    └─── 3. 응답 내용 비교
│    │         ├─── 4. 문자열 유사도
│    │         └─── 4. DOM 구조 비교
│    │
│    ├─── 2. 시간 분석
│    │    ├─── 3. 베이스라인 대비
│    │    ├─── 3. 임계값 판단
│    │    └─── 3. 노이즈 필터링
│    │
│    └─── 2. 오탐 제거
│         ├─── 3. 확인 테스트
│         └─── 3. 다중 검증
│
└─── 1. 결과 보고
     ├─── 2. 취약점 분류
     │    ├─── 3. 심각도
     │    └─── 3. 유형
     │
     ├─── 2. 증거 수집
     │    ├─── 3. 요청/응답 저장
     │    └─── 3. 재현 방법
     │
     └─── 2. 보고서 생성
```

---

### Branch 9: 관련 취약점/개념

```
관련 취약점/개념
├─── 1. 관련 인젝션 취약점
│    ├─── 2. NoSQL Injection
│    │    ├─── 3. MongoDB
│    │    │    ├─── 4. $where 인젝션
│    │    │    └─── 4. 연산자 인젝션
│    │    └─── 3. Redis
│    │
│    ├─── 2. LDAP Injection
│    ├─── 2. XPath Injection
│    ├─── 2. Command Injection
│    │    ├─── 3. OS 명령 인젝션
│    │    └─── 3. SQLi와의 차이점
│    │
│    └─── 2. Server-Side Template Injection
│
├─── 1. 관련 웹 취약점
│    ├─── 2. XSS (Cross-Site Scripting)
│    │    └─── 3. 출력 컨텍스트
│    ├─── 2. CSRF
│    └─── 2. 인증/인가 취약점
│
└─── 1. 보안 표준/분류
     ├─── 2. OWASP Top 10
     │    └─── 3. A03:2021 Injection
     ├─── 2. CWE
     │    ├─── 3. CWE-89: SQL Injection
     │    └─── 3. CWE-74: Injection
     └─── 2. CVSS
          └─── 3. 취약점 점수 체계
```

---

## 3. 원자화 우선순위

### Phase 1: 핵심 (필수)
1. **Branch 1**: SQL 언어 기초 - SQLi의 기반
2. **Branch 2**: DBMS 시스템 구조 - DBMS별 차이점
3. **Branch 7**: 공격 방법론 - 실제 공격 흐름

### Phase 2: 인프라 (중요)
4. **Branch 3**: HTTP 프로토콜 - 전송 계층
5. **Branch 4**: 인코딩 체계 - 우회 기법의 기반
6. **Branch 6**: WAF 및 보안 메커니즘 - 우회 대상

### Phase 3: 구현 (확장)
7. **Branch 5**: 입력 처리 및 검증 - 방어 관점
8. **Branch 8**: DAST 구현 - 도구 구현
9. **Branch 9**: 관련 취약점/개념 - 연결 지식

---

## 4. 다음 단계

1. 각 브랜치별로 원자 파일 생성
2. 원자 간 관계(relations) 정의
3. DBMS별 특화 정보 상세화
4. 페이로드 인스턴스 확장
5. 검증 및 테스트

---

## 부록: 예상 원자 ID 체계

| 분류 | ID 패턴 | 예시 |
|------|---------|------|
| 원칙 (Principle) | GR-SEC-PRI-XXXXX | GR-SEC-PRI-00001 |
| 개념 (Concept) | GR-SEC-CON-XXXXX | GR-SEC-CON-00001 |
| 기법 (Technique) | GR-SEC-TEC-XXXXX | GR-SEC-TEC-00001 |
| 컴포넌트 (Component) | GR-SEC-CMP-XXXXX | GR-SEC-CMP-00010 |
| 페이로드 (Payload) | GR-SEC-INS-PXXXX | GR-SEC-INS-P0001 |
| 핑거프린트 (Fingerprint) | GR-SEC-INS-FXXXX | GR-SEC-INS-F0001 |
| 우회 (Bypass) | GR-SEC-INS-BXXXX | GR-SEC-INS-B0001 |
| 함수 (Function) | GR-SEC-FUN-XXXXX | GR-SEC-FUN-00001 |
| 에러패턴 (Error) | GR-SEC-ERR-XXXXX | GR-SEC-ERR-00001 |
