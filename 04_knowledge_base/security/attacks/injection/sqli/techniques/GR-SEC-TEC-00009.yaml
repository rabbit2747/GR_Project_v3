# GR-SEC-TEC-00009: Encoding-based WAF Bypass

identity:
  id: GR-SEC-TEC-00009
  name: "Encoding-based WAF Bypass"
  normalization:
    normalized_name: "encoding based waf bypass"
    normalization_version: "1.0"
  aliases:
    - "URL Encoding Bypass"
    - "Double Encoding"
    - "인코딩 우회"
    - "Hex Encoding Bypass"

classification:
  domain: security
  type: technique
  is_infrastructure: false
  abstraction_level: 2
  gr_coordinates:
    layer: "L7"
    zone: "Z3"
    atom_tags:
      - "S-VUL-INJ"
      - "D-DB-SQL"
      - "T-EVA-BYPASS"

definition:
  what: |
    URL 인코딩, 16진수 인코딩, 유니코드 인코딩 등 다양한
    문자 인코딩을 사용하여 WAF의 패턴 매칭을 우회하는
    기법이다. WAF와 백엔드의 디코딩 차이를 악용한다.
  why: |
    WAF가 특정 인코딩만 디코딩하거나, 디코딩 횟수가
    백엔드와 다르면 우회가 가능하다. 특히 이중 인코딩이나
    혼합 인코딩이 효과적이다.
  how: |
    1. WAF의 디코딩 동작 파악
    2. 인코딩 방식 선택:
       - URL: %27 ('), %20 (space)
       - Double URL: %2527 (%27 → ')
       - Hex: 0x27 ('), 0x554e494f4e (UNION)
       - Unicode: %u0027 (')
       - HTML Entity: &#39; (')
    3. 혼합 인코딩으로 변형도 강화
    4. 예: UNI%4fN SEL%45CT

relations:
  structural:
    is_a:
      - GR-SEC-CON-00003  # WAF Bypass Technique (TODO)
  conditional:
    mitigates:
      - GR-SEC-CTL-00010  # WAF Keyword Filter (TODO)
    used_with:
      - GR-SEC-TEC-00001  # UNION-based
      - GR-SEC-TEC-00002  # Boolean-based
  applicability:
    applies_to:
      - GR-SEC-CMP-00010  # MySQL
      - GR-SEC-CMP-00011  # PostgreSQL
      - GR-SEC-CMP-00012  # MSSQL
      - GR-SEC-CMP-00013  # Oracle

constraints:
  - property: effectiveness
    base_value: 0.65
    conditions:
      - when:
          context_type: security
          condition: "waf_recursive_decode == true"
        then:
          value: 0.2
          reason: "재귀적 디코딩 시 이중 인코딩 무효화"
      - when:
          context_type: security
          condition: "waf_canonicalization == true"
        then:
          value: 0.1
          reason: "정규화 후 검사하면 대부분 우회 불가"

properties:
  security:
    severity: medium
    attack_phase: evasion
    stealth: high
    complexity: medium
    encoding_types:
      url_single: "%27 → '"
      url_double: "%2527 → %27 → '"
      hex_literal: "0x554e494f4e → UNION"
      unicode: "%u0027 → '"
      html_entity: "&#x27; → '"
      mixed: "UNI%4fN"
    examples:
      single_quote: "%27, %2527, 0x27, %u0027"
      union: "%55NION, UN%49ON, 0x554e494f4e"
      select: "SEL%45CT, %53ELECT"
      space: "%20, %09, %0a, %0d, /**/"

metadata:
  trust:
    source: research
    confidence: 1.0
    verified:
      status: verified
      date: "2025-01-26"
      by: "security-research"
  temporal:
    created: "2025-01-26"
    modified: "2025-01-26"
    revision: 1
  lineage:
    ingested_from:
      source_type: document
      source_uri: "../00_Foundation/02_SQLi_Bypass_Techniques.md"
      ingestion_date: "2025-01-26"
      ingestion_method: "expert_extraction"
    transformations: []
  security:
    sensitivity: public
    weaponization_risk: medium
  ai:
    embedding_text: |
      Encoding-based WAF Bypass는 URL, Hex, 유니코드 등
      다양한 인코딩으로 WAF 패턴 매칭을 우회하는 기법이다.
      WAF와 백엔드의 디코딩 동작 차이를 악용한다. 이중
      URL 인코딩(%2527)이나 혼합 인코딩(UNI%4fN)이 효과적이다.
      고급 WAF는 재귀 디코딩이나 정규화를 수행하여 방어한다.
    search_keywords:
      - "Encoding bypass"
      - "URL encoding"
      - "Double encoding"
      - "%2527"
      - "Hex encoding"
      - "인코딩 우회"
      - "0x"
    related_queries:
      - "이중 인코딩으로 WAF를 우회하는 방법은?"
      - "Hex 인코딩은 어떻게 사용하는가?"
      - "URL 인코딩으로 ' 를 어떻게 표현하는가?"
