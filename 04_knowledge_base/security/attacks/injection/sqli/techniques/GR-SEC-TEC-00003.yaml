# GR-SEC-TEC-00003: Blind Time-based SQL Injection

identity:
  id: GR-SEC-TEC-00003
  name: "Blind Time-based SQL Injection"
  normalization:
    normalized_name: "blind time based sql injection"
    normalization_version: "1.0"
  aliases:
    - "Time-based Blind SQLi"
    - "Time Delay SQLi"
    - "시간 기반 블라인드 SQLi"

classification:
  domain: security
  type: technique
  abstraction_level: 2
  gr_coordinates:
    layer: "L7"
    zone: "Z3"
    tags:
      - "S-VUL-INJ"
      - "D-DB-SQL"
      - "T-ATK-BLIND"

definition:
  what: |
    쿼리 결과와 응답 내용 모두 관찰할 수 없을 때, 조건부
    시간 지연(SLEEP, WAITFOR, pg_sleep 등)을 발생시켜
    응답 시간 차이로 정보를 추론하는 SQL Injection 기법이다.
  why: |
    가장 제한된 환경에서도 동작하는 최후의 수단이다.
    에러 메시지, 응답 차이가 전혀 없어도 시간 차이만으로
    데이터 추출이 가능하다.
  how: |
    1. 시간 지연 함수 사용 가능 여부 확인
    2. 조건부 지연 구성: IF(조건, SLEEP(5), 0)
    3. 응답 시간 측정으로 조건 참/거짓 판단
    4. 한 비트씩 데이터 추출
    예: AND IF(SUBSTRING(password,1,1)='a', SLEEP(5), 0)

relations:
  structural:
    is_a:
      - GR-SEC-CON-00002  # SQL Injection
  conditional:
    alternative_to:
      - GR-SEC-TEC-00001  # UNION-based
      - GR-SEC-TEC-00002  # Boolean-based
  applicability:
    applies_to:
      - GR-SEC-CMP-00010  # MySQL (SLEEP, BENCHMARK)
      - GR-SEC-CMP-00011  # PostgreSQL (pg_sleep)
      - GR-SEC-CMP-00012  # MSSQL (WAITFOR DELAY)
      - GR-SEC-CMP-00013  # Oracle (DBMS_LOCK.SLEEP)

constraints:
  - property: effectiveness
    base_value: 0.8
    conditions:
      - when:
          context_type: configuration
          condition: "time_functions_disabled == true"
        then:
          value: 0.2
          reason: "시간 함수 비활성화 시 heavy query로 대체"
      - when:
          context_type: environment
          condition: "network_latency_high == true"
        then:
          value: 0.5
          reason: "네트워크 지연이 크면 측정 어려움"

properties:
  security:
    severity: high
    attack_phase: exploitation
    data_exfiltration: true
    speed: very_slow
    stealth: medium
    dbms_functions:
      mysql: "SLEEP(), BENCHMARK()"
      postgresql: "pg_sleep()"
      mssql: "WAITFOR DELAY"
      oracle: "DBMS_LOCK.SLEEP()"

metadata:
  trust:
    source: research
    confidence: 1.0
    verified:
      status: verified
      date: "2025-01-26"
      by: "security-research"
  temporal:
    created: "2025-01-26"
    modified: "2025-01-26"
    revision: 1
  lineage:
    ingested_from:
      source_type: document
      source_uri: "../00_Foundation/01_SQLi_Complete_Guide.md"
      ingestion_date: "2025-01-26"
      ingestion_method: "expert_extraction"
    transformations: []
  security:
    sensitivity: public
    weaponization_risk: medium
  ai:
    embedding_text: |
      Time-based Blind SQL Injection은 응답 내용으로 판단이
      불가능할 때 시간 지연으로 정보를 추론하는 기법이다.
      MySQL의 SLEEP(), MSSQL의 WAITFOR DELAY, PostgreSQL의
      pg_sleep() 등을 사용한다. 조건이 참이면 지연, 거짓이면
      즉시 응답하도록 구성하여 한 비트씩 데이터를 추출한다.
      가장 느리지만 가장 제한된 환경에서도 동작한다.
    search_keywords:
      - "Time-based SQLi"
      - "SLEEP"
      - "WAITFOR DELAY"
      - "pg_sleep"
      - "시간 지연"
      - "Blind SQLi"
      - "BENCHMARK"
    related_queries:
      - "Time-based SQLi는 어떻게 하는가?"
      - "SLEEP 함수가 막혔을 때 대안은?"
      - "DBMS별 시간 지연 함수는?"
