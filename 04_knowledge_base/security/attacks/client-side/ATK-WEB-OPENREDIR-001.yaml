# GR Atom: Open Redirect Attack
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "ATK-WEB-OPENREDIR-001"
  name: "Open Redirect"
  normalization:
    normalized_name: "open redirect unvalidated redirect url redirect attack"
    normalization_version: "1.0"
  aliases:
    - "오픈 리다이렉트"
    - "Unvalidated Redirect"
    - "URL Redirect Attack"
    - "URL 리다이렉션 공격"

classification:
  domain: application
  type: technique
  is_infrastructure: false
  abstraction_level: 2
  gr_coordinates:
    layer: "L7"
    zone: "Z2"
    atom_tags: ["ATK", "WEB", "PHISHING"]

definition:
  what: |
    오픈 리다이렉트(Open Redirect)는 신뢰할 수 있는 도메인의 리다이렉트
    기능을 악용하여 사용자를 악성 사이트로 유도하는 공격이다. 정상 URL로
    시작하여 피싱 사이트로 연결한다.
  why: |
    사용자는 신뢰할 수 있는 도메인으로 시작하는 링크를 의심하지 않는다.
    피싱 공격의 효과를 높이고, OAuth 토큰 탈취에도 악용된다.
  how: |
    1. 리다이렉트 기능이 있는 URL 발견 (login, logout, return URL)
    2. 리다이렉트 대상을 외부 악성 URL로 변경
    3. 조작된 링크를 피해자에게 전송
    4. 피해자가 클릭하면 악성 사이트로 이동

relations:
  structural:
    is_a:
      - "TECH-CONCEPT-CLIENT-ATTACK-001"
  causal:
    exploits:
      - "VUL-CONFIG-MISCONFIG-001"
    targets:
      - "INFRA-APP-WEBAPP-001"
    enables:
      - "ATK-AUTH-CREDSTUFF-001"
    mitigated_by:
      - "DEF-PREVENT-INPUTVAL-001"

properties:
  technical:
    vulnerable_patterns:
      - pattern: "/redirect?url=https://evil.com"
        risk: "완전한 URL 허용"
      - pattern: "/login?next=/admin → next=//evil.com"
        risk: "프로토콜 상대 URL 우회"
      - pattern: "/goto?url=https://trusted.com@evil.com"
        risk: "URL 파싱 취약점"
    attack_use_cases:
      - name: "Phishing Enhancement"
        description: "신뢰 도메인 URL로 피싱 효과 증대"
      - name: "OAuth Token Theft"
        description: "OAuth 콜백 URL 조작으로 토큰 탈취"
      - name: "Malware Distribution"
        description: "악성코드 다운로드 페이지로 유도"
    prevention:
      - "화이트리스트 기반 리다이렉트 검증"
      - "상대 URL만 허용"
      - "사용자에게 외부 이동 경고"
    impact:
      - "피싱 공격 성공률 증가"
      - "자격 증명 탈취"
      - "OAuth 토큰 탈취"
      - "악성코드 배포"
  security:
    severity: medium
    cvss_base: 4.7
    cwe_id: "CWE-601"
    owasp_category: "A01:2021 - Broken Access Control"

metadata:
  trust:
    source: official
    references:
      - "CWE-601: URL Redirection to Untrusted Site"
      - "OWASP Unvalidated Redirects and Forwards"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      Open Redirect(오픈 리다이렉트)는 신뢰 도메인의 리다이렉트 기능을
      악용하여 악성 사이트로 유도하는 공격이다. 화이트리스트 검증으로 방어한다.
    search_keywords:
      - "Open Redirect"
      - "오픈 리다이렉트"
      - "URL Redirect"
      - "Unvalidated Redirect"
    related_queries:
      - "오픈 리다이렉트란?"
      - "리다이렉트 검증"
      - "OAuth 리다이렉트 보안"
