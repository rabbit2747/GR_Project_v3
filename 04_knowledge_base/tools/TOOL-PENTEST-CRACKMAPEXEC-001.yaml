# GR Atom: CrackMapExec
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "TOOL-PENTEST-CRACKMAPEXEC-001"
  name: "CrackMapExec"
  normalization:
    normalized_name: "crackmapexec cme smb ldap ad enumeration lateral"
    normalization_version: "1.0"
  aliases:
    - "CrackMapExec"
    - "CME"
    - "AD 스위스 아미 나이프"

classification:
  domain: security
  type: tool
  abstraction_level: 1
  gr_coordinates:
    layer: "L7"
    zone: "Z3"
    tags: ["TOOL", "PENTEST", "AD"]

definition:
  what: |
    Active Directory 네트워크를 열거하고 익스플로잇하는
    포스트 익스플로잇 도구이다.
  why: |
    대규모 AD 환경을 효율적으로 테스트한다.
    측면 이동을 수행한다.
  how: |
    1. 프로토콜 선택
    2. 타겟 지정
    3. 인증/열거
    4. 익스플로잇 실행

relations:
  structural:
    is_a:
      - "TOOL-PENTEST-001"

properties:
  technical:
    license: "BSD 2-Clause"
    language: "Python"
    protocols:
      - "SMB"
      - "LDAP"
      - "MSSQL"
      - "WinRM"
      - "SSH"
      - "RDP"
    capabilities:
      enumeration:
        - "사용자/그룹 열거"
        - "공유 열거"
        - "세션 열거"
        - "정책 열거"
      execution:
        - "Pass-the-Hash"
        - "Pass-the-Ticket"
        - "명령 실행"
        - "Mimikatz 통합"
      spray:
        - "패스워드 스프레이"
        - "자격증명 검증"
    usage_examples:
      enum_users: "cme smb DC -u user -p pass --users"
      pth: "cme smb target -u admin -H hash"
      spray: "cme smb targets -u users.txt -p 'Password123'"
      exec: "cme smb target -u admin -p pass -x 'whoami'"
    modules:
      - "Mimikatz"
      - "Lsassy"
      - "Empire"
      - "Metasploit"
    output:
      - "pwn3d! (관리자 접근)"
      - "[+] (성공)"
      - "[-] (실패)"
    repository: "https://github.com/byt3bl33d3r/CrackMapExec"
    successor: "NetExec"

metadata:
  trust:
    source: official
    references:
      - "CrackMapExec GitHub"
      - "AD Security"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      CrackMapExec(CME)는 Active Directory를 대규모로
      열거하고 익스플로잇하는 포스트 익스플로잇 도구이다.
    search_keywords:
      - "CrackMapExec"
      - "CME"
      - "AD Pentest"
      - "Lateral Movement"
    related_queries:
      - "CrackMapExec 사용법은?"
      - "CrackMapExec의 주요 기능은?"
      - "CrackMapExec으로 무엇을 할 수 있는가?"
