# GR Atom: Server-Side Request Forgery
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "VUL-WEB-SSRF-001"
  name: "Server-Side Request Forgery"
  normalization:
    normalized_name: "ssrf server side request forgery internal access"
    normalization_version: "1.0"
  aliases:
    - "SSRF"
    - "서버측 요청 위조"
    - "내부 네트워크 접근"

classification:
  domain: security
  type: vulnerability
  abstraction_level: 2
  gr_coordinates:
    layer: "L7"
    zone: "Zone2"
    tags: ["VUL", "WEB", "OWASP"]

definition:
  what: |
    서버가 사용자 입력을 기반으로 요청을 보낼 때
    내부 리소스나 임의의 외부 서버에 접근할 수 있는 취약점이다.
  why: |
    내부 네트워크에 접근할 수 있다.
    클라우드 메타데이터를 탈취할 수 있다.
  how: |
    1. URL 파라미터 식별
    2. 내부 IP/호스트 주입
    3. 프로토콜 조작
    4. 응답 분석

relations:
  structural:
    is_a:
      - "VUL-WEB-001"
    related_to:
      - "ATK-CLOUD-IMDS-001"
      - "VUL-WEB-XXE-001"

properties:
  technical:
    cwe_id: "CWE-918"
    owasp_rank: "OWASP Top 10 2021 - A10"
    attack_vectors:
      - "URL 파라미터"
      - "파일 업로드 URL"
      - "Webhook URL"
      - "PDF 생성기"
    targets:
      - "169.254.169.254 (Cloud Metadata)"
      - "localhost/127.0.0.1"
      - "내부 서비스"
      - "file:// 프로토콜"
    bypass_techniques:
      - "IP 인코딩 (0x7f.0.0.1)"
      - "DNS Rebinding"
      - "Redirect 악용"
      - "IPv6 (::1)"
    impact:
      - "내부 서비스 접근"
      - "자격 증명 탈취"
      - "포트 스캔"
      - "RCE 연계"
    prevention:
      - "URL 화이트리스트"
      - "DNS 검증"
      - "메타데이터 서비스 비활성화"
      - "네트워크 세그멘테이션"

metadata:
  trust:
    source: official
    references:
      - "OWASP SSRF"
      - "CWE-918"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      SSRF는 서버가 사용자 입력 URL로 요청을 보낼 때
      내부 네트워크에 접근할 수 있는 웹 취약점이다.
    search_keywords:
      - "SSRF"
      - "Server-Side Request Forgery"
      - "내부 접근"
      - "클라우드 메타데이터"
    related_queries:
      - "Server-Side Request Forgery 취약점이란?"
      - "Server-Side Request Forgery의 위험성은?"
      - "Server-Side Request Forgery을 어떻게 방어하는가?"
