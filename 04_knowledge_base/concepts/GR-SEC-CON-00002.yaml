# GR-SEC-CON-00002: SQL 인젝션

identity:
  id: GR-SEC-CON-00002
  name: "SQL 인젝션"
  normalization:
    normalized_name: "sql 인젝션"
    normalization_version: "1.0"
  aliases:
    - "SQLi"
    - "SQL 삽입 공격"
    - "SQL Injection"
    - "에스큐엘 인젝션"

classification:
  domain: security
  type: vulnerability
  abstraction_level: 3
  gr_coordinates:
    layer: "L7"
    zone: "Zone3"
    tags:
      - "S-VUL-INJ"
      - "D-DB-SQL"
      - "A-WEB-API"

definition:
  what: |
    사용자가 제공한 입력이 SQL 쿼리의 데이터가 아닌
    실행 가능한 SQL 코드로 해석되어, 공격자가 의도하지 않은
    SQL 명령을 실행할 수 있게 되는 보안 취약점이다.
  why: |
    데이터베이스의 기밀 정보 유출, 인증 우회, 데이터 무결성
    파괴, 나아가 운영체제 명령 실행(xp_cmdshell 등)까지
    이어질 수 있는 가장 위험한 웹 취약점 중 하나이다.
  how: |
    애플리케이션이 사용자 입력을 검증/이스케이프 없이
    SQL 쿼리 문자열에 직접 연결(concatenation)하면 발생한다.
    공격자는 따옴표('), 주석(--), 논리 연산자(OR 1=1) 등을
    입력하여 쿼리의 논리를 변경한다.

relations:
  structural:
    is_a:
      - GR-SEC-CON-00001  # 인젝션 취약점
  causal:
    causes:
      - GR-SEC-CON-00010  # 데이터 유출 (TODO)
      - GR-SEC-CON-00011  # 인증 우회 (TODO)
    enables:
      - GR-SEC-TEC-00050  # 권한 상승 (TODO)
      - GR-SEC-TEC-00051  # OS 명령 실행 (TODO)
  conditional:
    requires:
      - GR-SEC-CMP-00001  # SQL 데이터베이스 (TODO)
      - GR-SEC-CMP-00002  # 사용자 입력 처리 (TODO)
  applicability:
    applies_to:
      - GR-SEC-CMP-00010  # MySQL (TODO)
      - GR-SEC-CMP-00011  # PostgreSQL (TODO)
      - GR-SEC-CMP-00012  # MSSQL (TODO)
      - GR-SEC-CMP-00013  # Oracle (TODO)

properties:
  security:
    severity: critical
    cvss_base: 9.8
    cwe: "CWE-89"
    owasp: "A03:2021"
    exploitability: 0.95
    attack_vector: network
    privileges_required: none

metadata:
  trust:
    source: official
    references:
      - "https://cwe.mitre.org/data/definitions/89.html"
      - "https://owasp.org/Top10/A03_2021-Injection/"
    confidence: 1.0
    verified:
      status: verified
      date: "2025-01-26"
      by: "CWE-OWASP"
  temporal:
    created: "2025-01-26"
    modified: "2025-01-26"
    revision: 1
    valid_from: "1998-01-01"
  lineage:
    ingested_from:
      source_type: document
      source_uri: "../00_Foundation/01_SQLi_Complete_Guide.md"
      ingestion_date: "2025-01-26"
      ingestion_method: "전문가 추출"
    transformations: []
  security:
    sensitivity: public
    weaponization_risk: medium
  ai:
    embedding_text: |
      SQL 인젝션(SQLi)은 웹 애플리케이션의 가장 위험한
      보안 취약점 중 하나로, 사용자 입력이 SQL 쿼리의
      실행 코드로 해석되어 공격자가 데이터베이스를
      무단으로 조회, 수정, 삭제할 수 있게 한다.
      이는 입력 검증 없이 쿼리 문자열을 직접 조합할 때
      발생하며, Prepared Statement 사용으로 방지할 수 있다.
      UNION 기반, Blind, Error 기반 등 다양한 기법이 있다.
    search_keywords:
      - "SQL 인젝션"
      - "SQLi"
      - "SQL 삽입"
      - "데이터베이스 해킹"
      - "쿼리 조작"
      - "CWE-89"
      - "OWASP A03"
    related_queries:
      - "SQL 인젝션이란 무엇인가?"
      - "SQLi 공격은 어떻게 하는가?"
      - "SQL 인젝션을 어떻게 방어하는가?"
      - "SQLi와 XSS의 차이점은?"
