# GR-SEC-PRI-00001: 신뢰할 수 없는 입력-코드 혼합 위험 원칙

identity:
  id: GR-SEC-PRI-00001
  name: "신뢰할 수 없는 입력과 코드 혼합의 위험"
  normalization:
    normalized_name: "신뢰할 수 없는 입력 코드 혼합 위험"
    normalization_version: "1.0"
  aliases:
    - "입력-코드 혼합 위험"
    - "인젝션 근본 원인"
    - "데이터-코드 분리 실패"

classification:
  domain: security
  type: principle
  abstraction_level: 4
  gr_coordinates:
    layer: "L7"
    zone: "Z3"
    tags:
      - "S-VUL-INJ"
      - "P-SECURE-DESIGN"

definition:
  what: |
    신뢰할 수 없는 외부 입력이 실행 가능한 코드(SQL, OS 명령,
    HTML 등)와 구분 없이 혼합될 때, 공격자가 의도한 명령을
    주입하여 시스템을 제어할 수 있게 되는 근본적인 보안 위험이다.
  why: |
    모든 인젝션 공격(SQLi, XSS, Command Injection 등)의
    근본 원인이다. 이 원칙을 이해하면 다양한 인젝션 공격의
    본질을 파악하고 근본적인 방어 전략을 수립할 수 있다.
  how: |
    1. 사용자 입력이 코드 생성에 사용됨
    2. 입력과 코드 사이에 명확한 경계가 없음
    3. 입력 내 특수문자가 코드의 구조를 변경함
    4. 공격자가 의도한 코드가 실행됨

    방어: 데이터와 코드를 구조적으로 분리
    (Prepared Statement, 파라미터화된 쿼리 등)

relations:
  structural:
    abstracts:
      - GR-SEC-CON-00001  # 인젝션 취약점 패밀리

properties:
  security:
    severity: critical
    scope: universal
    applicable_to:
      - "SQL 쿼리"
      - "OS 명령"
      - "HTML/JavaScript"
      - "LDAP 쿼리"
      - "XML 파서"
      - "정규표현식"

metadata:
  trust:
    source: research
    confidence: 1.0
    verified:
      status: verified
      date: "2025-01-26"
      by: "보안연구팀"
  temporal:
    created: "2025-01-26"
    modified: "2025-01-26"
    revision: 1
  lineage:
    ingested_from:
      source_type: manual
      source_uri: "internal://gr-security-principles"
      ingestion_date: "2025-01-26"
      ingestion_method: "전문가 작성"
    transformations: []
  security:
    sensitivity: public
    weaponization_risk: low
  ai:
    embedding_text: |
      신뢰할 수 없는 입력과 코드 혼합의 위험은 모든 인젝션
      공격의 근본 원인이다. 사용자 입력이 SQL, OS 명령,
      HTML 등의 코드와 구분 없이 결합되면 공격자가 코드
      구조를 변경하여 의도치 않은 명령을 실행할 수 있다.
      Prepared Statement 등으로 데이터와 코드를 구조적으로
      분리하는 것이 근본적인 해결책이다.
    search_keywords:
      - "인젝션 원인"
      - "입력 코드 혼합"
      - "데이터 코드 분리"
      - "Prepared Statement"
      - "파라미터화 쿼리"
    related_queries:
      - "인젝션 공격의 근본 원인은?"
      - "왜 Prepared Statement를 사용해야 하는가?"
      - "데이터와 코드를 어떻게 분리하는가?"
