# GR Atom: AS-REP Roasting
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "ATK-WIN-ASREP-001"
  name: "AS-REP Roasting"
  normalization:
    normalized_name: "asrep roasting kerberos preauth disabled cracking"
    normalization_version: "1.0"
  aliases:
    - "AS-REP Roasting"
    - "ASREPRoast"
    - "Kerberos Pre-Auth Attack"

classification:
  domain: security
  type: technique
  abstraction_level: 2
  gr_coordinates:
    layer: "L7"
    zone: "Zone3"
    tags: ["ATK", "AD", "KERBEROS"]

definition:
  what: |
    Kerberos 사전 인증이 비활성화된 계정의 AS-REP 응답을
    요청하고 오프라인에서 크래킹하여 비밀번호를 획득하는 공격이다.
  why: |
    사전 인증 없이 비밀번호 해시를 획득한다.
    취약한 계정 설정을 악용한다.
  how: |
    1. Pre-Auth 비활성화 계정 열거
    2. AS-REQ 요청
    3. AS-REP 응답 수신
    4. 오프라인 크래킹

relations:
  structural:
    is_a:
      - "ATK-KERBEROS-001"
    related_to:
      - "ATK-WIN-KERBEROASTING-001"
      - "TOOL-PENTEST-RUBEUS-001"
      - "INFRA-KERBEROS-001"

properties:
  technical:
    mitre_id: "T1558.004"
    requirements:
      - "도메인 사용자 목록 (또는 사용자명 추측)"
      - "'Do not require Kerberos preauthentication' 설정된 계정"
    vulnerability:
      setting: "DONT_REQ_PREAUTH"
      uac_flag: "0x400000"
    process:
      - "Pre-Auth 비활성화 계정 검색"
      - "AS-REQ 요청 (without pre-auth)"
      - "AS-REP 응답 수신 (암호화된 TGT)"
      - "krb5asrep 해시 추출"
      - "Hashcat/John 크래킹"
    tools:
      enumeration:
        - "GetNPUsers.py (Impacket)"
        - "Rubeus asreproast"
        - "PowerView Get-DomainUser"
      cracking:
        - "Hashcat (mode 18200)"
        - "John the Ripper"
    hashcat_mode: "18200 (Kerberos 5 AS-REP)"
    detection:
      - "Event ID 4768 (pre-auth 실패 없이 TGT 요청)"
      - "단기간 다수 AS-REQ"
      - "RC4 암호화 요청"
    prevention:
      - "Pre-Auth 활성화 강제"
      - "강력한 비밀번호 정책"
      - "계정 설정 감사"
      - "AES 암호화 강제"
    comparison_kerberoasting:
      similarity: "오프라인 크래킹 기법"
      difference: "TGS 대신 AS-REP 타겟"
      advantage: "인증 없이도 공격 가능"

metadata:
  trust:
    source: official
    references:
      - "MITRE ATT&CK T1558.004"
      - "HarmJ0y Blog"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      AS-REP Roasting은 Kerberos 사전 인증이 비활성화된 계정의
      AS-REP를 크래킹하여 비밀번호를 획득하는 AD 공격이다.
    search_keywords:
      - "AS-REP Roasting"
      - "ASREPRoast"
      - "Kerberos"
      - "Pre-Authentication"
    related_queries:
      - "AS-REP Roasting 기법이란?"
      - "AS-REP Roasting 공격 방법은?"
      - "AS-REP Roasting을 어떻게 탐지하는가?"
