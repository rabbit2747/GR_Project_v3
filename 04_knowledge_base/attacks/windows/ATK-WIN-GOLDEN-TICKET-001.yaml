# GR Atom: Golden Ticket Attack
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "ATK-WIN-GOLDEN-TICKET-001"
  name: "Golden Ticket Attack"
  normalization:
    normalized_name: "golden ticket kerberos tgt forgery krbtgt persistence"
    normalization_version: "1.0"
  aliases:
    - "Golden Ticket"
    - "TGT Forgery"
    - "골든 티켓 공격"

classification:
  domain: security
  type: technique
  abstraction_level: 2
  gr_coordinates:
    layer: "L7"
    zone: "Zone3"
    tags: ["ATK", "AD", "KERBEROS"]

definition:
  what: |
    KRBTGT 계정의 해시로 위조된 TGT를 생성하여
    도메인 내 모든 리소스에 무제한 접근하는 공격이다.
  why: |
    도메인 전체에 영구적 접근을 확보한다.
    탐지 없이 장기 지속성을 유지한다.
  how: |
    1. KRBTGT 해시 획득 (DCSync)
    2. 위조 TGT 생성
    3. 메모리에 티켓 주입
    4. 도메인 리소스 접근

relations:
  structural:
    is_a:
      - "ATK-KERBEROS-001"
    related_to:
      - "ATK-WIN-DCSYNC-001"
      - "ATK-WIN-SILVER-TICKET-001"
      - "TOOL-PENTEST-MIMIKATZ-001"

properties:
  technical:
    mitre_id: "T1558.001"
    prerequisites:
      - "KRBTGT 해시"
      - "도메인 SID"
      - "도메인 이름"
    tools:
      - "Mimikatz (kerberos::golden)"
      - "Impacket (ticketer.py)"
      - "Rubeus"
    mimikatz_command: |
      kerberos::golden /user:Administrator /domain:corp.local
      /sid:S-1-5-21-... /krbtgt:HASH /ptt
    ticket_properties:
      - "임의의 사용자 이름"
      - "임의의 그룹 멤버십"
      - "최대 10년 유효 기간"
    persistence:
      - "KRBTGT 비밀번호 2회 변경 전까지 유효"
      - "오프라인에서도 티켓 생성 가능"
    detection:
      - "Event ID 4769 (비정상 TGS 요청)"
      - "TGT 수명 이상"
      - "비정상 그룹 멤버십"
    defense:
      - "KRBTGT 비밀번호 정기 변경"
      - "Privileged Access Workstation"
      - "티어드 접근 모델"
      - "행위 분석 (UEBA)"

metadata:
  trust:
    source: official
    references:
      - "MITRE ATT&CK T1558.001"
      - "ADSecurity.org"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      Golden Ticket은 KRBTGT 해시로 TGT를 위조하여
      도메인 전체에 영구적 접근을 확보하는 Kerberos 공격이다.
    search_keywords:
      - "Golden Ticket"
      - "Kerberos"
      - "KRBTGT"
      - "TGT Forgery"
    related_queries:
      - "Golden Ticket Attack 기법이란?"
      - "Golden Ticket Attack 공격 방법은?"
      - "Golden Ticket Attack을 어떻게 탐지하는가?"
