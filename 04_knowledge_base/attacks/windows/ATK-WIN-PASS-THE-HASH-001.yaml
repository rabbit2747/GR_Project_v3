# GR Atom: Pass-the-Hash
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "ATK-WIN-PASS-THE-HASH-001"
  name: "Pass-the-Hash"
  normalization:
    normalized_name: "pass the hash pth ntlm authentication lateral movement"
    normalization_version: "1.0"
  aliases:
    - "Pass-the-Hash"
    - "PtH"
    - "해시 전달 공격"

classification:
  domain: security
  type: technique
  abstraction_level: 2
  gr_coordinates:
    layer: "L7"
    zone: "Z3"
    tags: ["ATK", "WIN", "LATERAL"]

definition:
  what: |
    평문 비밀번호 없이 NTLM 해시만으로
    Windows 시스템에 인증하는 측면 이동 기법이다.
  why: |
    비밀번호 크래킹 없이 접근한다.
    네트워크 내 측면 이동을 수행한다.
  how: |
    1. NTLM 해시 획득
    2. 해시로 NTLM 인증
    3. 원격 시스템 접근
    4. 추가 해시 수집

relations:
  structural:
    is_a:
      - "ATK-LATERAL-001"

properties:
  technical:
    mitre_id: "T1550.002"
    prerequisites:
      - "NTLM 해시 (NT Hash)"
      - "타겟 시스템 관리자 권한"
    tools:
      - name: "Mimikatz"
        command: "sekurlsa::pth /user:admin /ntlm:HASH /domain:corp"
      - name: "Impacket"
        command: "psexec.py -hashes :NTLM_HASH domain/user@target"
      - name: "CrackMapExec"
        command: "cme smb target -u user -H NTLM_HASH"
    protocols_affected:
      - "SMB"
      - "WMI"
      - "WinRM"
      - "RPC"
    not_affected:
      - "Kerberos (해시로 TGT 요청 불가)"
      - "NTLM v2 (일부 제한)"
    detection:
      - "Event ID 4624 (Type 3, NTLM)"
      - "Event ID 4776 (NTLM 인증)"
      - "비정상 관리자 로그인"
    defense:
      - "Credential Guard"
      - "Protected Users 그룹"
      - "LAPS (Local Admin Password Solution)"
      - "특권 계정 분리"
      - "SMB 서명 필수화"

metadata:
  trust:
    source: official
    references:
      - "MITRE ATT&CK T1550.002"
      - "Microsoft PtH Guidance"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      Pass-the-Hash는 NTLM 해시만으로 Windows 시스템에
      인증하여 측면 이동하는 공격 기법이다.
    search_keywords:
      - "Pass-the-Hash"
      - "PtH"
      - "NTLM"
      - "측면 이동"
    related_queries:
      - "Pass-the-Hash 기법이란?"
      - "Pass-the-Hash 공격 방법은?"
      - "Pass-the-Hash을 어떻게 탐지하는가?"
