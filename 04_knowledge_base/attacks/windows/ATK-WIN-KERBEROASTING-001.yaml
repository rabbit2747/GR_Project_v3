# GR Atom: Kerberoasting
# Version: 1.0
# Created: 2025-01-29

identity:
  id: "ATK-WIN-KERBEROASTING-001"
  name: "Kerberoasting"
  normalization:
    normalized_name: "kerberoasting spn service ticket cracking offline"
    normalization_version: "1.0"
  aliases:
    - "Kerberoasting"
    - "SPN Cracking"
    - "커버로스팅"

classification:
  domain: security
  type: technique
  abstraction_level: 2
  gr_coordinates:
    layer: "L7"
    zone: "Zone3"
    tags: ["ATK", "AD", "KERBEROS"]

definition:
  what: |
    서비스 계정의 SPN에 대한 서비스 티켓을 요청하고
    오프라인에서 크래킹하여 비밀번호를 획득하는 공격이다.
  why: |
    서비스 계정 비밀번호를 획득한다.
    높은 권한의 계정을 장악한다.
  how: |
    1. SPN 열거
    2. TGS 티켓 요청
    3. 티켓 추출
    4. 오프라인 크래킹

relations:
  structural:
    is_a:
      - "ATK-KERBEROS-001"
    related_to:
      - "ATK-WIN-ASREP-001"
      - "TOOL-PENTEST-RUBEUS-001"

properties:
  technical:
    mitre_id: "T1558.003"
    requirements:
      - "도메인 사용자 자격 증명"
      - "SPN이 등록된 서비스 계정"
    process:
      - "SPN 열거 (setspn, LDAP)"
      - "TGS-REQ 요청"
      - "서비스 티켓 수신"
      - "RC4 해시 추출"
      - "Hashcat/John 크래킹"
    tools:
      enumeration:
        - "GetUserSPNs.py (Impacket)"
        - "Rubeus kerberoast"
        - "setspn -Q */*"
      cracking:
        - "Hashcat (mode 13100)"
        - "John the Ripper"
    hashcat_mode: "13100 (Kerberos 5 TGS-REP)"
    detection:
      - "Event ID 4769 (비정상 암호화 유형)"
      - "단기간 다수 TGS 요청"
      - "RC4 암호화 요청"
    prevention:
      - "긴/복잡한 서비스 계정 비밀번호"
      - "gMSA (Group Managed Service Accounts)"
      - "AES만 허용"
      - "서비스 계정 모니터링"

metadata:
  trust:
    source: official
    references:
      - "MITRE ATT&CK T1558.003"
      - "ADSecurity.org"
    confidence: 1.0
    verified:
      status: verified
      date: 2025-01-29
      by: "GR System"
  temporal:
    created: 2025-01-29
    modified: 2025-01-29
    revision: 1
  security:
    sensitivity: public
  ai:
    embedding_text: |
      Kerberoasting은 서비스 계정의 TGS 티켓을 요청하고
      오프라인 크래킹으로 비밀번호를 획득하는 AD 공격이다.
    search_keywords:
      - "Kerberoasting"
      - "SPN"
      - "Service Ticket"
      - "TGS Cracking"
    related_queries:
      - "Kerberoasting 기법이란?"
      - "Kerberoasting 공격 방법은?"
      - "Kerberoasting을 어떻게 탐지하는가?"
